import{A as re,B as Bc,C as Uc,D as bn,E as zc,F as Gc,G as jc,H as ye,I as $c,J as Wt,K as Kc,L as Qc,M as Wc,N as Hc,O as Yc,P as An,Q as Xc,R as Jc,S as Zc,T as tu,U as eu,V as ve,W as nu,X as ru,_ as iu,ba as ie,ca as su,da as ou,f as Dc,ga as au,h as Vc,ja as Rr,ka as cu,ma as uu,n as kc,o as Mc,p as Nc,q as Tt,qa as lu,ra as Dr,t as Oc,u as Fc,v as Lc,w as xr,x as ne,y as Pr,z as qc}from"./chunk-GSM5PAAS.js";import{$b as cs,A as ns,Ab as pe,B as lc,Bb as Mt,Cb as br,Db as as,Eb as ze,Fa as pc,Fb as Ge,Ga as _c,Gb as Ic,Hb as gt,Ib as Ar,J as hc,Jb as Tc,Kb as Ec,Lb as bc,Mb as Ac,N as rs,Nb as Cc,Ob as J,Pb as Sc,Qb as Cr,Rb as Sr,Ua as j,V as is,Va as H,W as dc,Y as mc,_ as ss,_b as _e,a as es,ab as kt,b as cc,ba as At,bb as Tn,ca as X,d as x,da as Rt,db as yc,dc as xc,e as L,ea as Qt,eb as vc,f as bt,fa as yr,ga as qe,h as y,ha as Be,hb as os,hc as Pc,ia as Ue,ic as Rc,jc as pt,k as _r,ka as Dt,la as Vt,lb as vr,mb as wr,na as ge,nb as mt,ob as te,pb as wc,qb as Ir,ra as fc,rb as Tr,sb as Er,ta as gc,tb as D,ub as N,v as wn,va as W,vb as yt,w as uc,wa as In,wb as En,yb as ft,zb as ee}from"./chunk-YYPME23C.js";var Wd=["*",[["mat-toolbar-row"]]],Hd=["*","mat-toolbar-row"],Yd=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=Qt({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0});let e=t;return e})(),Vr=(()=>{let t=class t{constructor(r,i,s){this._elementRef=r,this._platform=i,this._document=s}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}};t.\u0275fac=function(i){return new(i||t)(H(Ue),H(Vc),H(xc))},t.\u0275cmp=X({type:t,selectors:[["mat-toolbar"]],contentQueries:function(i,s,o){if(i&1&&br(o,Yd,5),i&2){let a;ze(a=Ge())&&(s._toolbarRows=a)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(i,s){i&2&&(wc(s.color?"mat-"+s.color:""),te("mat-toolbar-multiple-rows",s._toolbarRows.length>0)("mat-toolbar-single-row",s._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[J],ngContentSelectors:Hd,decls:2,vars:0,template:function(i,s){i&1&&(pe(Wd),Mt(0),Mt(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color);--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color)}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0});let e=t;return e})();var kr=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Rt({type:t}),t.\u0275inj=Vt({imports:[Tt,Tt]});let e=t;return e})();function Xd(e,t){e&1&&(D(0,"div")(1,"button",1)(2,"span"),gt(3,"Login"),N()(),D(4,"button",2)(5,"span"),gt(6,"Join Us"),N()()())}function Jd(e,t){if(e&1){let n=En();D(0,"div")(1,"button",3),ft("click",function(){qe(n);let i=ee();return Be(i.logout())}),D(2,"span"),gt(3,"Logout"),N()()()}}var mu=(()=>{var t;let n=class n{constructor(i,s,o){L(this,t,void 0);this.responsive=i,this.minWidth728=!1,this.maxWidth728=!0,this.condition=kt(!0),bt(this,t,W(ie)),this.mobileQuery=s.matchMedia("(max-width: 960px)"),this._mobileQueryListener=()=>o.detectChanges(),this.mobileQuery.addEventListener("change",this._mobileQueryListener)}ngOnInit(){this.setBreakpointObserver()}setBreakpointObserver(){let i="(min-width: 728px)",s="(max-width: 728px)";this.responsive.observe([i,s]).subscribe(o=>{let a=o.breakpoints;this.minWidth728=a[i],this.maxWidth728=a[s],this.condition.update(c=>c=!this.minWidth728&&this.maxWidth728)})}logout(){x(this,t).logout()}get isAuthenticated(){return x(this,t).isAuthenticated}};t=new WeakMap,n.\u0275fac=function(s){return new(s||n)(H(Mc),H(kc),H(Tn))},n.\u0275cmp=X({type:n,selectors:[["app-toolbar"]],standalone:!0,features:[J],decls:6,vars:1,consts:[[1,"spacer"],["mat-flat-button","","routerLink","/login"],["mat-stroked-button","","routerLink","/register"],["mat-flat-button","",3,"click"]],template:function(s,o){s&1&&(D(0,"mat-toolbar")(1,"h1"),gt(2,"SOCIAL THOUGHTS"),N(),yt(3,"span",0),vr(4,Xd,7,0,"div")(5,Jd,4,0),N()),s&2&&(j(4),Ir(4,o.isAuthenticated?5:4))},dependencies:[pt,kr,Vr,re,Pr,ne,Dc],styles:["[_nghost-%COMP%]{position:sticky;top:0;z-index:1;background-color:#fafafa}[_nghost-%COMP%]   mat-toolbar[_ngcontent-%COMP%]{height:8vh}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{color:#444;font-size:3vmin;font-family:Lucida Sans,Lucida Sans Regular,Lucida Grande,Lucida Sans Unicode,Geneva,Verdana,sans-serif;letter-spacing:.1rem}[_nghost-%COMP%]   div[_ngcontent-%COMP%]{display:flex;gap:1vmin;align-items:center}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{letter-spacing:.1rem;color:#444;font-size:2vmin;font-weight:lighter}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-of-type(1)   span[_ngcontent-%COMP%]{text-decoration:underline}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-of-type(2){border:1px solid #A212D5}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-of-type(2)   span[_ngcontent-%COMP%]{color:#a212d5}@media (min-width: 728px){[_nghost-%COMP%]   mat-toolbar[_ngcontent-%COMP%]{height:12vh}}",".spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-toolbar[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-fab[_ngcontent-%COMP%]{background:linear-gradient(to right bottom,#eb054e,#db0a84,#a212d5)}.mat-mdc-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-unelevated-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-card-content[_ngcontent-%COMP%]{padding-bottom:16px}.mat-mdc-radio-button.mat-primary[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color: #fff;--mdc-radio-disabled-unselected-icon-color: #fff;--mdc-radio-unselected-hover-icon-color: #fff;--mdc-radio-unselected-icon-color: #fff;--mdc-radio-unselected-pressed-icon-color: #fff;--mdc-radio-selected-hover-icon-color: #fff;--mdc-radio-selected-focus-icon-color: #fff;--mdc-radio-selected-icon-color: #fff;--mdc-radio-selected-pressed-icon-color: #fff;--mat-radio-ripple-color: #fff;--mat-radio-checked-ripple-color: #fff;--mat-radio-disabled-label-color: #fff}"],changeDetection:0});let e=n;return e})();var fu=(()=>{let t=class t{constructor(){this._listeners=[]}notify(r,i){for(let s of this._listeners)s(r,i)}listen(r){return this._listeners.push(r),()=>{this._listeners=this._listeners.filter(i=>r!==i)}}ngOnDestroy(){this._listeners=[]}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Dt({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var tm=["input"],em=["formField"],nm=["*"],gu=0,Mr=class{constructor(t,n){this.source=t,this.value=n}},rm={provide:su,useExisting:gc(()=>us),multi:!0},pu=new ge("MatRadioGroup"),im=new ge("mat-radio-default-options",{providedIn:"root",factory:sm});function sm(){return{color:"accent"}}var us=(()=>{let t=class t{get name(){return this._name}set name(r){this._name=r,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(r){this._labelPosition=r==="before"?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(r){this._value!==r&&(this._value=r,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(r){this._selected=r,this.value=r?r.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(r){this._disabled=r,this._markRadiosForCheck()}get required(){return this._required}set required(r){this._required=r,this._markRadiosForCheck()}constructor(r){this._changeDetector=r,this._value=null,this._name=`mat-radio-group-${gu++}`,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new ss}ngAfterContentInit(){this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(()=>{this.selected&&!this._radios.find(r=>r===this.selected)&&(this._selected=null)})}ngOnDestroy(){this._buttonChanges?.unsubscribe()}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(r=>{r.name=this.name,r._markForCheck()})}_updateSelectedRadioFromValue(){let r=this._selected!==null&&this._selected.value===this._value;this._radios&&!r&&(this._selected=null,this._radios.forEach(i=>{i.checked=this.value===i.value,i.checked&&(this._selected=i)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new Mr(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(r=>r._markForCheck())}writeValue(r){this.value=r,this._changeDetector.markForCheck()}registerOnChange(r){this._controlValueAccessorChangeFn=r}registerOnTouched(r){this.onTouched=r}setDisabledState(r){this.disabled=r,this._changeDetector.markForCheck()}};t.\u0275fac=function(i){return new(i||t)(H(Tn))},t.\u0275dir=Qt({type:t,selectors:[["mat-radio-group"]],contentQueries:function(i,s,o){if(i&1&&br(o,_u,5),i&2){let a;ze(a=Ge())&&(s._radios=a)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:[At.HasDecoratorInputTransform,"disabled","disabled",_e],required:[At.HasDecoratorInputTransform,"required","required",_e]},outputs:{change:"change"},exportAs:["matRadioGroup"],standalone:!0,features:[Cc([rm,{provide:pu,useExisting:t}]),os]});let e=t;return e})(),_u=(()=>{let t=class t{get checked(){return this._checked}set checked(r){this._checked!==r&&(this._checked=r,r&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!r&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),r&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(r){this._value!==r&&(this._value=r,this.radioGroup!==null&&(this.checked||(this.checked=this.radioGroup.value===r),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(r){this._labelPosition=r}get disabled(){return this._disabled||this.radioGroup!==null&&this.radioGroup.disabled}set disabled(r){this._setDisabled(r)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(r){this._required=r}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(r){this._color=r}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(r,i,s,o,a,c,u,l){this._elementRef=i,this._changeDetector=s,this._focusMonitor=o,this._radioDispatcher=a,this._providerOverride=u,this._uniqueId=`mat-radio-${++gu}`,this.id=this._uniqueId,this.disableRipple=!1,this.tabIndex=0,this.change=new ss,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this.radioGroup=r,this._noopAnimations=c==="NoopAnimations",l&&(this.tabIndex=cs(l,0))}focus(r,i){i?this._focusMonitor.focusVia(this._inputElement,i,r):this._inputElement.nativeElement.focus(r)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((r,i)=>{r!==this.id&&i===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(r=>{!r&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new Mr(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(r){r.stopPropagation()}_onInputInteraction(r){if(r.stopPropagation(),!this.checked&&!this.disabled){let i=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),i&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(r){this._onInputInteraction(r),this.disabled||this._inputElement.nativeElement.focus()}_setDisabled(r){this._disabled!==r&&(this._disabled=r,this._changeDetector.markForCheck())}_updateTabIndex(){let r=this.radioGroup,i;if(!r||!r.selected||this.disabled?i=this.tabIndex:i=r.selected===this?this.tabIndex:-1,i!==this._previousTabIndex){let s=this._inputElement?.nativeElement;s&&(s.setAttribute("tabindex",i+""),this._previousTabIndex=i)}}};t.\u0275fac=function(i){return new(i||t)(H(pu,8),H(Ue),H(Tn),H(Nc),H(fu),H(fc,8),H(im,8),pc("tabindex"))},t.\u0275cmp=X({type:t,selectors:[["mat-radio-button"]],viewQuery:function(i,s){if(i&1&&(as(tm,5),as(em,7,Ue)),i&2){let o;ze(o=Ge())&&(s._inputElement=o.first),ze(o=Ge())&&(s._rippleTrigger=o.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:15,hostBindings:function(i,s){i&1&&ft("focus",function(){return s._inputElement.nativeElement.focus()}),i&2&&(wr("id",s.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),te("mat-primary",s.color==="primary")("mat-accent",s.color==="accent")("mat-warn",s.color==="warn")("mat-mdc-radio-checked",s.checked)("_mat-animation-noopable",s._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[At.None,"aria-label","ariaLabel"],ariaLabelledby:[At.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[At.None,"aria-describedby","ariaDescribedby"],disableRipple:[At.HasDecoratorInputTransform,"disableRipple","disableRipple",_e],tabIndex:[At.HasDecoratorInputTransform,"tabIndex","tabIndex",r=>r==null?0:cs(r)],checked:[At.HasDecoratorInputTransform,"checked","checked",_e],value:"value",labelPosition:"labelPosition",disabled:[At.HasDecoratorInputTransform,"disabled","disabled",_e],required:[At.HasDecoratorInputTransform,"required","required",_e],color:"color"},outputs:{change:"change"},exportAs:["matRadioButton"],standalone:!0,features:[os,J],ngContentSelectors:nm,decls:13,vars:16,consts:[["mat-internal-form-field","",3,"labelPosition"],["formField",""],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"id","checked","disabled","required","change"],["input",""],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(i,s){i&1&&(pe(),D(0,"div",0,1)(2,"div",2)(3,"div",3),ft("click",function(a){return s._onTouchTargetClick(a)}),N(),D(4,"input",4,5),ft("change",function(a){return s._onInputInteraction(a)}),N(),D(6,"div",6),yt(7,"div",7)(8,"div",8),N(),D(9,"div",9),yt(10,"div",10),N()(),D(11,"label",11),Mt(12),N()()),i&2&&(mt("labelPosition",s.labelPosition),j(2),te("mdc-radio--disabled",s.disabled),j(2),mt("id",s.inputId)("checked",s.checked)("disabled",s.disabled)("required",s.required),wr("name",s.name)("value",s.value)("aria-label",s.ariaLabel)("aria-labelledby",s.ariaLabelledby)("aria-describedby",s.ariaDescribedby),j(5),mt("matRippleTrigger",s._rippleTrigger.nativeElement)("matRippleDisabled",s._isRippleDisabled())("matRippleCentered",!0),j(2),mt("for",s.inputId))},dependencies:[Oc,Lc],styles:['.mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color}.mdc-radio[hidden]{display:none}.mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;z-index:1}.mdc-radio--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-radio--touch .mdc-radio__native-control{top:calc((40px - 48px) / 2);right:calc((40px - 48px) / 2);left:calc((40px - 48px) / 2);width:48px;height:48px}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{border-color:CanvasText}}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{border-color:CanvasText}}.mdc-radio__native-control:checked+.mdc-radio__background,.mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio--disabled{cursor:default;pointer-events:none}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:disabled+.mdc-radio__background,[aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background{cursor:default}.mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{padding:calc((var(--mdc-radio-state-layer-size) - 20px) / 2)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-disabled-selected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-unselected-icon-opacity)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{top:calc(-1 * (var(--mdc-radio-state-layer-size) - 20px) / 2);left:calc(-1 * (var(--mdc-radio-state-layer-size) - 20px) / 2);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control{top:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);right:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);left:calc((var(--mdc-radio-state-layer-size) - var(--mdc-radio-state-layer-size)) / 2);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color)}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple .mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, black)}.mat-mdc-radio-button.cdk-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-radio-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display)}[dir=rtl] .mat-mdc-radio-touch-target{left:0;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0});let e=t;return e})(),yu=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Rt({type:t}),t.\u0275inj=Vt({imports:[Tt,pt,Fc,_u,Tt]});let e=t;return e})();var Nr=(()=>{var t;let n=class n{constructor(){L(this,t,kt(!1))}get seletor(){return x(this,t).asReadonly()}setSeletor(i){x(this,t).update(s=>s=i)}};t=new WeakMap,n.\u0275fac=function(s){return new(s||n)},n.\u0275prov=Dt({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();var je=(()=>{var t,n;let r=class r{constructor(){L(this,t,new Rr(null));L(this,n,kt(null))}get userInput$(){return x(this,t).valueChanges.pipe(mc(s=>{x(this,n).update(o=>o=s)}),is(null),hc(400),rs())}get userInputSignal(){return x(this,n).asReadonly()}get userInputValue(){return x(this,t).value}set userInput(s){bt(this,t,s)}};t=new WeakMap,n=new WeakMap,r.\u0275fac=function(o){return new(o||r)},r.\u0275prov=Dt({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();var am=(e,t)=>t.id;function cm(e,t){}var vu=(()=>{var t,n;let r=class r{constructor(){L(this,t,void 0);L(this,n,void 0);this.userInput=new Rr(null),this.selectedRadio=1,bt(this,t,W(Nr)),bt(this,n,W(je)),this.authService=W(ie).isAuthenticatedSignal}ngOnInit(){x(this,n).userInput=this.userInput}select(s){let o=this.options.find(a=>a.id===s);x(this,t).setSeletor(o?.option)}get options(){return[{id:1,option:!1,name:"SEARCH"},{id:2,option:!0,name:"ADD"}]}};t=new WeakMap,n=new WeakMap,r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=X({type:r,selectors:[["app-search-bar"]],standalone:!0,features:[J],decls:5,vars:2,consts:[["type","text","placeholder","write your thought...","rows","2",3,"formControl"],[3,"ngModel","ngModelChange"]],template:function(o,a){o&1&&(D(0,"mat-toolbar"),yt(1,"textarea",0),D(2,"mat-radio-group",1),Ac("ngModelChange",function(u){return bc(a.selectedRadio,u)||(a.selectedRadio=u),u}),ft("ngModelChange",function(u){return a.select(u)}),Tr(3,cm,0,0,null,null,am),N()()),o&2&&(j(),mt("formControl",a.userInput),j(),Ec("ngModel",a.selectedRadio),j(),Er(a.options))},dependencies:[pt,kr,Vr,re,ne,yu,us,lu,ou,au,cu,Dr,uu],styles:["[_nghost-%COMP%]{position:sticky;top:8vh;z-index:1}[_nghost-%COMP%]   mat-toolbar[_ngcontent-%COMP%]{position:relative;background:linear-gradient(to right bottom,#eb054e,#db0a84,#a212d5)}[_nghost-%COMP%]   mat-toolbar[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;border:1px solid #DB0A84;border-radius:4px;outline:none;padding:4px 16px;min-height:36px;max-height:100px;resize:vertical;color:#333;font-style:italic;letter-spacing:.05rem}[_nghost-%COMP%]   mat-toolbar[_ngcontent-%COMP%]   mat-radio-group[_ngcontent-%COMP%]{padding-left:16px}[_nghost-%COMP%]   mat-toolbar[_ngcontent-%COMP%]   mat-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;letter-spacing:.1rem;font-weight:lighter;font-size:2vmin}@media (min-width: 728px){[_nghost-%COMP%]{top:12vh}}",".spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-toolbar[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-fab[_ngcontent-%COMP%]{background:linear-gradient(to right bottom,#eb054e,#db0a84,#a212d5)}.mat-mdc-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-unelevated-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-card-content[_ngcontent-%COMP%]{padding-bottom:16px}.mat-mdc-radio-button.mat-primary[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color: #fff;--mdc-radio-disabled-unselected-icon-color: #fff;--mdc-radio-unselected-hover-icon-color: #fff;--mdc-radio-unselected-icon-color: #fff;--mdc-radio-unselected-pressed-icon-color: #fff;--mdc-radio-selected-hover-icon-color: #fff;--mdc-radio-selected-focus-icon-color: #fff;--mdc-radio-selected-icon-color: #fff;--mdc-radio-selected-pressed-icon-color: #fff;--mat-radio-ripple-color: #fff;--mat-radio-checked-ripple-color: #fff;--mat-radio-disabled-label-color: #fff}"],changeDetection:0});let e=r;return e})();var um=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},St={},p,Ds=Ds||{},E=um||self;function Hr(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function qn(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function lm(e){return Object.prototype.hasOwnProperty.call(e,ls)&&e[ls]||(e[ls]=++hm)}var ls="closure_uid_"+(1e9*Math.random()>>>0),hm=0;function dm(e,t,n){return e.call.apply(e.bind,arguments)}function mm(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function ot(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ot=dm:ot=mm,ot.apply(null,arguments)}function Or(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function tt(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return t.prototype[i].apply(r,o)}}function se(){this.s=this.s,this.o=this.o}var fm=0;se.prototype.s=!1;se.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),fm!=0)&&lm(this)};se.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Vu=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Vs(e){let t=e.length;if(0<t){let n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function wu(e,t){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Hr(r)){let i=e.length||0,s=r.length||0;e.length=i+s;for(let o=0;o<s;o++)e[i+o]=r[o]}else e.push(r)}}function at(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}at.prototype.h=function(){this.defaultPrevented=!0};var gm=function(){if(!E.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let n=()=>{};E.addEventListener("test",n,t),E.removeEventListener("test",n,t)}catch{}return e}();function Dn(e){return/^[\s\xa0]*$/.test(e)}function Yr(){var e=E.navigator;return e&&(e=e.userAgent)?e:""}function Nt(e){return Yr().indexOf(e)!=-1}function ks(e){return ks[" "](e),e}ks[" "]=function(){};function pm(e,t){var n=sf;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}var _m=Nt("Opera"),We=Nt("Trident")||Nt("MSIE"),ku=Nt("Edge"),gs=ku||We,Mu=Nt("Gecko")&&!(Yr().toLowerCase().indexOf("webkit")!=-1&&!Nt("Edge"))&&!(Nt("Trident")||Nt("MSIE"))&&!Nt("Edge"),ym=Yr().toLowerCase().indexOf("webkit")!=-1&&!Nt("Edge");function Nu(){var e=E.document;return e?e.documentMode:void 0}var ps;t:{if(Fr="",Lr=function(){var e=Yr();if(Mu)return/rv:([^\);]+)(\)|;)/.exec(e);if(ku)return/Edge\/([\d\.]+)/.exec(e);if(We)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(ym)return/WebKit\/(\S+)/.exec(e);if(_m)return/(?:Version)[ \/]?(\S+)/.exec(e)}(),Lr&&(Fr=Lr?Lr[1]:""),We&&(qr=Nu(),qr!=null&&qr>parseFloat(Fr))){ps=String(qr);break t}ps=Fr}var Fr,Lr,qr,_s;E.document&&We?(hs=Nu(),_s=hs||parseInt(ps,10)||void 0):_s=void 0;var hs,vm=_s;function Vn(e,t){if(at.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Mu){t:{try{ks(t.nodeName);var i=!0;break t}catch{}i=!1}i||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:wm[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Vn.$.h.call(this)}}tt(Vn,at);var wm={2:"touch",3:"pen",4:"mouse"};Vn.prototype.h=function(){Vn.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Bn="closure_listenable_"+(1e6*Math.random()|0),Im=0;function Tm(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++Im,this.fa=this.ia=!1}function Xr(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Ms(e,t,n){for(let r in e)t.call(n,e[r],r,e)}function Em(e,t){for(let n in e)t.call(void 0,e[n],n,e)}function Ou(e){let t={};for(let n in e)t[n]=e[n];return t}var Iu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Fu(e,t){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(let s=0;s<Iu.length;s++)n=Iu[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Jr(e){this.src=e,this.g={},this.h=0}Jr.prototype.add=function(e,t,n,r,i){var s=e.toString();e=this.g[s],e||(e=this.g[s]=[],this.h++);var o=vs(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):(t=new Tm(t,this.src,s,!!r,i),t.ia=n,e.push(t)),t};function ys(e,t){var n=t.type;if(n in e.g){var r=e.g[n],i=Vu(r,t),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Xr(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function vs(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}var Ns="closure_lm_"+(1e6*Math.random()|0),ds={};function Lu(e,t,n,r,i){if(r&&r.once)return Bu(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Lu(e,t[s],n,r,i);return null}return n=Ls(n),e&&e[Bn]?e.O(t,n,qn(r)?!!r.capture:!!r,i):qu(e,t,n,!1,r,i)}function qu(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=qn(i)?!!i.capture:!!i,a=Fs(e);if(a||(e[Ns]=a=new Jr(e)),n=a.add(t,n,r,o,s),n.proxy)return n;if(r=bm(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)gm||(i=o),i===void 0&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(zu(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function bm(){function e(n){return t.call(e.src,e.listener,n)}let t=Am;return e}function Bu(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Bu(e,t[s],n,r,i);return null}return n=Ls(n),e&&e[Bn]?e.P(t,n,qn(r)?!!r.capture:!!r,i):qu(e,t,n,!0,r,i)}function Uu(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Uu(e,t[s],n,r,i);else r=qn(r)?!!r.capture:!!r,n=Ls(n),e&&e[Bn]?(e=e.i,t=String(t).toString(),t in e.g&&(s=e.g[t],n=vs(s,n,r,i),-1<n&&(Xr(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete e.g[t],e.h--)))):e&&(e=Fs(e))&&(t=e.g[t.toString()],e=-1,t&&(e=vs(t,n,r,i)),(n=-1<e?t[e]:null)&&Os(n))}function Os(e){if(typeof e!="number"&&e&&!e.fa){var t=e.src;if(t&&t[Bn])ys(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(zu(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Fs(t))?(ys(n,e),n.h==0&&(n.src=null,t[Ns]=null)):Xr(e)}}}function zu(e){return e in ds?ds[e]:ds[e]="on"+e}function Am(e,t){if(e.fa)e=!0;else{t=new Vn(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Os(e),e=n.call(r,t)}return e}function Fs(e){return e=e[Ns],e instanceof Jr?e:null}var ms="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ls(e){return typeof e=="function"?e:(e[ms]||(e[ms]=function(t){return e.handleEvent(t)}),e[ms])}function Z(){se.call(this),this.i=new Jr(this),this.S=this,this.J=null}tt(Z,se);Z.prototype[Bn]=!0;Z.prototype.removeEventListener=function(e,t,n,r){Uu(this,e,t,n,r)};function it(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,typeof t=="string")t=new at(t,e);else if(t instanceof at)t.target=t.target||e;else{var i=t;t=new at(r,e),Fu(t,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Br(o,r,!0,t)&&i}if(o=t.g=e,i=Br(o,r,!0,t)&&i,i=Br(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)o=t.g=n[s],i=Br(o,r,!1,t)&&i}Z.prototype.N=function(){if(Z.$.N.call(this),this.i){var e=this.i,t;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Xr(n[r]);delete e.g[t],e.h--}}this.J=null};Z.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)};Z.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function Br(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&ys(e.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var qs=E.JSON.stringify,ws=class{constructor(t,n){this.i=t,this.j=n,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}};function Cm(){var e=Bs;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Is=class{constructor(){this.h=this.g=null}add(t,n){let r=Gu.get();r.set(t,n),this.h?this.h.next=r:this.g=r,this.h=r}},Gu=new ws(()=>new Ts,e=>e.reset()),Ts=class{constructor(){this.next=this.g=this.h=null}set(t,n){this.h=t,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function Sm(e){var t=1;e=e.split(":");let n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function xm(e){E.setTimeout(()=>{throw e},0)}var kn,Mn=!1,Bs=new Is,ju=()=>{let e=E.Promise.resolve(void 0);kn=()=>{e.then(Pm)}},Pm=()=>{for(var e;e=Cm();){try{e.h.call(e.g)}catch(n){xm(n)}var t=Gu;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Mn=!1};function Zr(e,t){Z.call(this),this.h=e||1,this.g=t||E,this.j=ot(this.qb,this),this.l=Date.now()}tt(Zr,Z);p=Zr.prototype;p.ga=!1;p.T=null;p.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),it(this,"tick"),this.ga&&(Us(this),this.start()))}};p.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Us(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}p.N=function(){Zr.$.N.call(this),Us(this),delete this.g};function zs(e,t,n){if(typeof e=="function")n&&(e=ot(e,n));else if(e&&typeof e.handleEvent=="function")e=ot(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:E.setTimeout(e,t||0)}function $u(e){e.g=zs(()=>{e.g=null,e.i&&(e.i=!1,$u(e))},e.j);let t=e.h;e.h=null,e.m.apply(null,t)}var Es=class extends se{constructor(t,n){super(),this.m=t,this.j=n,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:$u(this)}N(){super.N(),this.g&&(E.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Nn(e){se.call(this),this.h=e,this.g={}}tt(Nn,se);var Tu=[];function Ku(e,t,n,r){Array.isArray(n)||(n&&(Tu[0]=n.toString()),n=Tu);for(var i=0;i<n.length;i++){var s=Lu(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Qu(e){Ms(e.g,function(t,n){this.g.hasOwnProperty(n)&&Os(t)},e),e.g={}}Nn.prototype.N=function(){Nn.$.N.call(this),Qu(this)};Nn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ti(){this.g=!0}ti.prototype.Ea=function(){this.g=!1};function Rm(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&h[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+`
`+n+`
`+o})}function Dm(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+`
`+n+`
`+s+" "+o})}function Ke(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+km(e,n)+(r?" "+r:"")})}function Vm(e,t){e.info(function(){return"TIMEOUT: "+t})}ti.prototype.info=function(){};function km(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return qs(n)}catch{return t}}var Ee={},Eu=null;function ei(){return Eu=Eu||new Z}Ee.Ta="serverreachability";function Wu(e){at.call(this,Ee.Ta,e)}tt(Wu,at);function On(e){let t=ei();it(t,new Wu(t))}Ee.STAT_EVENT="statevent";function Hu(e,t){at.call(this,Ee.STAT_EVENT,e),this.stat=t}tt(Hu,at);function lt(e){let t=ei();it(t,new Hu(t,e))}Ee.Ua="timingevent";function Yu(e,t){at.call(this,Ee.Ua,e),this.size=t}tt(Yu,at);function Un(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return E.setTimeout(function(){e()},t)}var ni={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Xu={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Gs(){}Gs.prototype.h=null;function bu(e){return e.h||(e.h=e.i())}function Ju(){}var zn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function js(){at.call(this,"d")}tt(js,at);function $s(){at.call(this,"c")}tt($s,at);var bs;function ri(){}tt(ri,Gs);ri.prototype.g=function(){return new XMLHttpRequest};ri.prototype.i=function(){return{}};bs=new ri;function Gn(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Nn(this),this.P=Mm,e=gs?125:void 0,this.V=new Zr(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Zu}function Zu(){this.i=null,this.g="",this.h=!1}var Mm=45e3,tl={},As={};p=Gn.prototype;p.setTimeout=function(e){this.P=e};function Cs(e,t,n){e.L=1,e.A=si(Yt(t)),e.u=n,e.S=!0,el(e,null)}function el(e,t){e.G=Date.now(),jn(e),e.B=Yt(e.A);var n=e.B,r=e.W;Array.isArray(r)||(r=[String(r)]),ul(n.i,"t",r),e.o=0,n=e.l.J,e.h=new Zu,e.g=Rl(e.l,n?t:null,!e.u),0<e.O&&(e.M=new Es(ot(e.Pa,e,e.g),e.O)),Ku(e.U,e.g,"readystatechange",e.nb),t=e.I?Ou(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),On(),Rm(e.j,e.v,e.B,e.m,e.W,e.u)}p.nb=function(e){e=e.target;let t=this.M;t&&Ot(e)==3?t.l():this.Pa(e)};p.Pa=function(e){try{if(e==this.g)t:{let l=Ot(this.g);var t=this.g.Ia();let h=this.g.da();if(!(3>l)&&(l!=3||gs||this.g&&(this.h.h||this.g.ja()||xu(this.g)))){this.J||l!=4||t==7||(t==8||0>=h?On(3):On(2)),ii(this);var n=this.g.da();this.ca=n;e:if(nl(this)){var r=xu(this.g);e="";var i=r.length,s=Ot(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){we(this),Rn(this);var o="";break e}this.h.i=new E.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.length=0,this.h.g+=e,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,Dm(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Dn(a)){var u=a;break e}}u=null}if(n=u)Ke(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ss(this,n);else{this.i=!1,this.s=3,lt(12),we(this),Rn(this);break t}}this.S?(rl(this,l,o),gs&&this.i&&l==3&&(Ku(this.U,this.V,"tick",this.mb),this.V.start())):(Ke(this.j,this.m,o,null),Ss(this,o)),l==4&&we(this),this.i&&!this.J&&(l==4?Cl(this.l,this):(this.i=!1,jn(this)))}else ef(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,lt(12)):(this.s=0,lt(13)),we(this),Rn(this)}}}catch{}finally{}};function nl(e){return e.g?e.v=="GET"&&e.L!=2&&e.l.Ha:!1}function rl(e,t,n){let r=!0,i;for(;!e.J&&e.o<n.length;)if(i=Nm(e,n),i==As){t==4&&(e.s=4,lt(14),r=!1),Ke(e.j,e.m,null,"[Incomplete Response]");break}else if(i==tl){e.s=4,lt(15),Ke(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}else Ke(e.j,e.m,i,null),Ss(e,i);nl(e)&&e.o!=0&&(e.h.g=e.h.g.slice(e.o),e.o=0),t!=4||n.length!=0||e.h.h||(e.s=1,lt(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,t=e.l,t.g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xs(t),t.M=!0,lt(11))):(Ke(e.j,e.m,n,"[Invalid Chunked Response]"),we(e),Rn(e))}p.mb=function(){if(this.g){var e=Ot(this.g),t=this.g.ja();this.o<t.length&&(ii(this),rl(this,e,t),this.i&&e!=4&&jn(this))}};function Nm(e,t){var n=e.o,r=t.indexOf(`
`,n);return r==-1?As:(n=Number(t.substring(n,r)),isNaN(n)?tl:(r+=1,r+n>t.length?As:(t=t.slice(r,r+n),e.o=r+n,t)))}p.cancel=function(){this.J=!0,we(this)};function jn(e){e.Y=Date.now()+e.P,il(e,e.P)}function il(e,t){if(e.C!=null)throw Error("WatchDog timer not null");e.C=Un(ot(e.lb,e),t)}function ii(e){e.C&&(E.clearTimeout(e.C),e.C=null)}p.lb=function(){this.C=null;let e=Date.now();0<=e-this.Y?(Vm(this.j,this.B),this.L!=2&&(On(),lt(17)),we(this),this.s=2,Rn(this)):il(this,this.Y-e)};function Rn(e){e.l.H==0||e.J||Cl(e.l,e)}function we(e){ii(e);var t=e.M;t&&typeof t.sa=="function"&&t.sa(),e.M=null,Us(e.V),Qu(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Ss(e,t){try{var n=e.l;if(n.H!=0&&(n.g==e||xs(n.i,e))){if(!e.K&&xs(n.i,e)&&n.H==3){try{var r=n.Ja.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){t:if(!n.u){if(n.g)if(n.g.G+3e3<e.G)$r(n),ci(n);else break t;Ys(n),lt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Un(ot(n.ib,n),6e3));if(1>=dl(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Ie(n,11)}else if((e.K||n.g==e)&&$r(n),!Dn(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));let d=u[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let g=e.g;if(g){let S=g.g?g.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(S){var s=r.i;s.g||S.indexOf("spdy")==-1&&S.indexOf("quic")==-1&&S.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Ks(s,s.h),s.h=null))}if(r.F){let b=g.g?g.g.getResponseHeader("X-HTTP-Session-Id"):null;b&&(r.Da=b,F(r.I,r.F,b))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=e;if(r.wa=Pl(r,r.J?r.pa:null,r.Y),o.K){ml(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(ii(a),jn(a)),r.g=o}else bl(r);0<n.j.length&&ui(n)}else u[0]!="stop"&&u[0]!="close"||Ie(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?Ie(n,7):Hs(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}On(4)}catch{}}function Om(e){if(e.Z&&typeof e.Z=="function")return e.Z();if(typeof Map<"u"&&e instanceof Map||typeof Set<"u"&&e instanceof Set)return Array.from(e.values());if(typeof e=="string")return e.split("");if(Hr(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}t=[],n=0;for(r in e)t[n++]=e[r];return t}function Fm(e){if(e.ta&&typeof e.ta=="function")return e.ta();if(!e.Z||typeof e.Z!="function"){if(typeof Map<"u"&&e instanceof Map)return Array.from(e.keys());if(!(typeof Set<"u"&&e instanceof Set)){if(Hr(e)||typeof e=="string"){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(let r in e)t[n++]=r;return t}}}function sl(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(Hr(e)||typeof e=="string")Array.prototype.forEach.call(e,t,void 0);else for(var n=Fm(e),r=Om(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}var ol=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Lm(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Te(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Te){this.h=e.h,Gr(this,e.j),this.s=e.s,this.g=e.g,jr(this,e.m),this.l=e.l;var t=e.i,n=new Fn;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Au(this,n),this.o=e.o}else e&&(t=String(e).match(ol))?(this.h=!1,Gr(this,t[1]||"",!0),this.s=xn(t[2]||""),this.g=xn(t[3]||"",!0),jr(this,t[4]),this.l=xn(t[5]||"",!0),Au(this,t[6]||"",!0),this.o=xn(t[7]||"")):(this.h=!1,this.i=new Fn(null,this.h))}Te.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Pn(t,Cu,!0),":");var n=this.g;return(n||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Pn(t,Cu,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&e.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&e.push("/"),e.push(Pn(n,n.charAt(0)=="/"?Um:Bm,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Pn(n,Gm)),e.join("")};function Yt(e){return new Te(e)}function Gr(e,t,n){e.j=n?xn(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function jr(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Au(e,t,n){t instanceof Fn?(e.i=t,jm(e.i,e.h)):(n||(t=Pn(t,zm)),e.i=new Fn(t,e.h))}function F(e,t,n){e.i.set(t,n)}function si(e){return F(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function xn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Pn(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,qm),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function qm(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Cu=/[#\/\?@]/g,Bm=/[#\?:]/g,Um=/[#\?]/g,zm=/[#\?@]/g,Gm=/#/g;function Fn(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function oe(e){e.g||(e.g=new Map,e.h=0,e.i&&Lm(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}p=Fn.prototype;p.add=function(e,t){oe(this),this.i=null,e=He(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function al(e,t){oe(e),t=He(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function cl(e,t){return oe(e),t=He(e,t),e.g.has(t)}p.forEach=function(e,t){oe(this),this.g.forEach(function(n,r){n.forEach(function(i){e.call(t,i,r,this)},this)},this)};p.ta=function(){oe(this);let e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){let i=e[r];for(let s=0;s<i.length;s++)n.push(t[r])}return n};p.Z=function(e){oe(this);let t=[];if(typeof e=="string")cl(this,e)&&(t=t.concat(this.g.get(He(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t};p.set=function(e,t){return oe(this),this.i=null,e=He(this,e),cl(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};p.get=function(e,t){return e?(e=this.Z(e),0<e.length?String(e[0]):t):t};function ul(e,t,n){al(e,t),0<n.length&&(e.i=null,e.g.set(He(e,t),Vs(n)),e.h+=n.length)}p.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};function He(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function jm(e,t){t&&!e.j&&(oe(e),e.i=null,e.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(al(this,r),ul(this,i,n))},e)),e.j=t}var $m=class{constructor(e,t){this.g=e,this.map=t}};function ll(e){this.l=e||Km,E.PerformanceNavigationTiming?(e=E.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(E.g&&E.g.Ka&&E.g.Ka()&&E.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Km=10;function hl(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function dl(e){return e.h?1:e.g?e.g.size:0}function xs(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Ks(e,t){e.g?e.g.add(t):e.h=t}function ml(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}ll.prototype.cancel=function(){if(this.i=fl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let e of this.g.values())e.cancel();this.g.clear()}};function fl(e){if(e.h!=null)return e.i.concat(e.h.F);if(e.g!=null&&e.g.size!==0){let t=e.i;for(let n of e.g.values())t=t.concat(n.F);return t}return Vs(e.i)}var Qm=class{stringify(e){return E.JSON.stringify(e,void 0)}parse(e){return E.JSON.parse(e,void 0)}};function Wm(){this.g=new Qm}function Hm(e,t,n){let r=n||"";try{sl(e,function(i,s){let o=i;qn(i)&&(o=qs(i)),t.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Ym(e,t){let n=new ti;if(E.Image){let r=new Image;r.onload=Or(Ur,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Or(Ur,n,r,"TestLoadImage: error",!1,t),r.onabort=Or(Ur,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Or(Ur,n,r,"TestLoadImage: timeout",!1,t),E.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function Ur(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch{}}function $n(e){this.l=e.ec||null,this.j=e.ob||!1}tt($n,Gs);$n.prototype.g=function(){return new oi(this.l,this.j)};$n.prototype.i=function(e){return function(){return e}}({});function oi(e,t){Z.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Qs,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}tt(oi,Z);var Qs=0;p=oi.prototype;p.open=function(e,t){if(this.readyState!=Qs)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Ln(this)};p.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||E).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};p.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Kn(this)),this.readyState=Qs};p.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ln(this)),this.g&&(this.readyState=3,Ln(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof E.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;gl(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))};function gl(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}p.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Kn(this):Ln(this),this.readyState==3&&gl(this)}};p.Za=function(e){this.g&&(this.response=this.responseText=e,Kn(this))};p.Ya=function(e){this.g&&(this.response=e,Kn(this))};p.ka=function(){this.g&&Kn(this)};function Kn(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Ln(e)}p.setRequestHeader=function(e,t){this.v.append(e,t)};p.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};p.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join(`\r
`)};function Ln(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(oi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var Xm=E.JSON.parse;function q(e){Z.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=pl,this.L=this.M=!1}tt(q,Z);var pl="",Jm=/^https?$/i,Zm=["POST","PUT"];p=q.prototype;p.Oa=function(e){this.M=e};p.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():bs.g(),this.C=this.u?bu(this.u):bu(bs),this.g.onreadystatechange=ot(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){Su(this,s);return}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=E.FormData&&e instanceof E.FormData,!(0<=Vu(Zm,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{vl(this),0<this.B&&((this.L=tf(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ot(this.ua,this)):this.A=zs(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Su(this,s)}};function tf(e){return We&&typeof e.timeout=="number"&&e.ontimeout!==void 0}p.ua=function(){typeof Ds<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,it(this,"timeout"),this.abort(8))};function Su(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,_l(e),ai(e)}function _l(e){e.F||(e.F=!0,it(e,"complete"),it(e,"error"))}p.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,it(this,"complete"),it(this,"abort"),ai(this))};p.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ai(this,!0)),q.$.N.call(this)};p.La=function(){this.s||(this.G||this.v||this.l?yl(this):this.kb())};p.kb=function(){yl(this)};function yl(e){if(e.h&&typeof Ds<"u"&&(!e.C[1]||Ot(e)!=4||e.da()!=2)){if(e.v&&Ot(e)==4)zs(e.La,0,e);else if(it(e,"readystatechange"),Ot(e)==4){e.h=!1;try{let o=e.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break t;default:t=!1}var n;if(!(n=t)){var r;if(r=o===0){var i=String(e.I).match(ol)[1]||null;!i&&E.self&&E.self.location&&(i=E.self.location.protocol.slice(0,-1)),r=!Jm.test(i?i.toLowerCase():"")}n=r}if(n)it(e,"complete"),it(e,"success");else{e.m=6;try{var s=2<Ot(e)?e.g.statusText:""}catch{s=""}e.j=s+" ["+e.da()+"]",_l(e)}}finally{ai(e)}}}}function ai(e,t){if(e.g){vl(e);let n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||it(e,"ready");try{n.onreadystatechange=r}catch{}}}function vl(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(E.clearTimeout(e.A),e.A=null)}p.isActive=function(){return!!this.g};function Ot(e){return e.g?e.g.readyState:0}p.da=function(){try{return 2<Ot(this)?this.g.status:-1}catch{return-1}};p.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};p.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),Xm(t)}};function xu(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case pl:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function ef(e){let t={};e=(e.g&&2<=Ot(e)&&e.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<e.length;r++){if(Dn(e[r]))continue;var n=Sm(e[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=t[i]||[];t[i]=s,s.push(n)}Em(t,function(r){return r.join(", ")})}p.Ia=function(){return this.m};p.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function wl(e){let t="";return Ms(e,function(n,r){t+=r,t+=":",t+=n,t+=`\r
`}),t}function Ws(e,t,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=wl(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):F(e,t,n))}function Cn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Il(e){this.Ga=0,this.j=[],this.l=new ti,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Cn("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Cn("baseRetryDelayMs",5e3,e),this.hb=Cn("retryDelaySeedMs",1e4,e),this.eb=Cn("forwardChannelMaxRetries",2,e),this.xa=Cn("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new ll(e&&e.concurrentRequestLimit),this.Ja=new Wm,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}p=Il.prototype;p.ra=8;p.H=1;function Hs(e){if(Tl(e),e.H==3){var t=e.W++,n=Yt(e.I);if(F(n,"SID",e.K),F(n,"RID",t),F(n,"TYPE","terminate"),Qn(e,n),t=new Gn(e,e.l,t),t.L=2,t.A=si(Yt(n)),n=!1,E.navigator&&E.navigator.sendBeacon)try{n=E.navigator.sendBeacon(t.A.toString(),"")}catch{}!n&&E.Image&&(new Image().src=t.A,n=!0),n||(t.g=Rl(t.l,null),t.g.ha(t.A)),t.G=Date.now(),jn(t)}xl(e)}function ci(e){e.g&&(Xs(e),e.g.cancel(),e.g=null)}function Tl(e){ci(e),e.u&&(E.clearTimeout(e.u),e.u=null),$r(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&E.clearTimeout(e.m),e.m=null)}function ui(e){if(!hl(e.i)&&!e.m){e.m=!0;var t=e.Na;kn||ju(),Mn||(kn(),Mn=!0),Bs.add(t,e),e.C=0}}function nf(e,t){return dl(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.j=t.F.concat(e.j),!0):e.H==1||e.H==2||e.C>=(e.cb?0:e.eb)?!1:(e.m=Un(ot(e.Na,e,t),Sl(e,e.C)),e.C++,!0)}p.Na=function(e){if(this.m)if(this.m=null,this.H==1){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;let i=new Gn(this,this.l,e),s=this.s;if(this.U&&(s?(s=Ou(s),Fu(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)t:{for(var t=0,n=0;n<this.j.length;n++){e:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break e}r=void 0}if(r===void 0)break;if(t+=r,4096<t){t=n;break t}if(t===4096||n===this.j.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=El(this,i,t),n=Yt(this.I),F(n,"RID",e),F(n,"CVER",22),this.F&&F(n,"X-HTTP-Session-Id",this.F),Qn(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(wl(s)))+"&"+t:this.o&&Ws(n,this.o,s)),Ks(this.i,i),this.bb&&F(n,"TYPE","init"),this.P?(F(n,"$req",t),F(n,"SID","null"),i.aa=!0,Cs(i,n,null)):Cs(i,n,t),this.H=2}}else this.H==3&&(e?Pu(this,e):this.j.length==0||hl(this.i)||Pu(this))};function Pu(e,t){var n;t?n=t.m:n=e.W++;let r=Yt(e.I);F(r,"SID",e.K),F(r,"RID",n),F(r,"AID",e.V),Qn(e,r),e.o&&e.s&&Ws(r,e.o,e.s),n=new Gn(e,e.l,n,e.C+1),e.o===null&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=El(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Ks(e.i,n),Cs(n,r,t)}function Qn(e,t){e.na&&Ms(e.na,function(n,r){F(t,r,n)}),e.h&&sl({},function(n,r){F(t,r,n)})}function El(e,t,n){n=Math.min(e.j.length,n);var r=e.h?ot(e.h.Va,e.h,e):null;t:{var i=e.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{Hm(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break t}}}return e=e.j.splice(0,n),t.F=e,r}function bl(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;kn||ju(),Mn||(kn(),Mn=!0),Bs.add(t,e),e.A=0}}function Ys(e){return e.g||e.u||3<=e.A?!1:(e.ba++,e.u=Un(ot(e.Ma,e),Sl(e,e.A)),e.A++,!0)}p.Ma=function(){if(this.u=null,Al(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Un(ot(this.jb,this),e)}};p.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,lt(10),ci(this),Al(this))};function Xs(e){e.B!=null&&(E.clearTimeout(e.B),e.B=null)}function Al(e){e.g=new Gn(e,e.l,"rpc",e.ba),e.o===null&&(e.g.I=e.s),e.g.O=0;var t=Yt(e.wa);F(t,"RID","rpc"),F(t,"SID",e.K),F(t,"AID",e.V),F(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&F(t,"TO",e.qa),F(t,"TYPE","xmlhttp"),Qn(e,t),e.o&&e.s&&Ws(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.A=si(Yt(t)),n.u=null,n.S=!0,el(n,e)}p.ib=function(){this.v!=null&&(this.v=null,ci(this),Ys(this),lt(19))};function $r(e){e.v!=null&&(E.clearTimeout(e.v),e.v=null)}function Cl(e,t){var n=null;if(e.g==t){$r(e),Xs(e),e.g=null;var r=2}else if(xs(e.i,t))n=t.F,ml(e.i,t),r=1;else return;if(e.H!=0){if(t.i)if(r==1){n=t.u?t.u.length:0,t=Date.now()-t.G;var i=e.C;r=ei(),it(r,new Yu(r,n)),ui(e)}else bl(e);else if(i=t.s,i==3||i==0&&0<t.ca||!(r==1&&nf(e,t)||r==2&&Ys(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Ie(e,5);break;case 4:Ie(e,10);break;case 3:Ie(e,6);break;default:Ie(e,2)}}}function Sl(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Ie(e,t){if(e.l.info("Error code "+t),t==2){var n=null;e.h&&(n=null);var r=ot(e.pb,e);n||(n=new Te("//www.google.com/images/cleardot.gif"),E.location&&E.location.protocol=="http"||Gr(n,"https"),si(n)),Ym(n.toString(),r)}else lt(2);e.H=0,e.h&&e.h.za(t),xl(e),Tl(e)}p.pb=function(e){e?(this.l.info("Successfully pinged google.com"),lt(2)):(this.l.info("Failed to ping google.com"),lt(1))};function xl(e){if(e.H=0,e.ma=[],e.h){let t=fl(e.i);(t.length!=0||e.j.length!=0)&&(wu(e.ma,t),wu(e.ma,e.j),e.i.i.length=0,Vs(e.j),e.j.length=0),e.h.ya()}}function Pl(e,t,n){var r=n instanceof Te?Yt(n):new Te(n);if(r.g!="")t&&(r.g=t+"."+r.g),jr(r,r.m);else{var i=E.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Te(null);r&&Gr(s,r),t&&(s.g=t),i&&jr(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&F(r,n,t),F(r,"VER",e.ra),Qn(e,r),r}function Rl(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=e.Ha&&!e.va?new q(new $n({ob:n})):new q(e.va),t.Oa(e.J),t}p.isActive=function(){return!!this.h&&this.h.isActive(this)};function Dl(){}p=Dl.prototype;p.Ba=function(){};p.Aa=function(){};p.za=function(){};p.ya=function(){};p.isActive=function(){return!0};p.Va=function(){};function Kr(){if(We&&!(10<=Number(vm)))throw Error("Environmental error: no available transport.")}Kr.prototype.g=function(e,t){return new vt(e,t)};function vt(e,t){Z.call(this),this.g=new Il(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Dn(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Dn(t)&&(this.g.F=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new Ye(this)}tt(vt,Z);vt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;lt(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Pl(e,null,e.Y),ui(e)};vt.prototype.close=function(){Hs(this.g)};vt.prototype.u=function(e){var t=this.g;if(typeof e=="string"){var n={};n.__data__=e,e=n}else this.v&&(n={},n.__data__=qs(e),e=n);t.j.push(new $m(t.fb++,e)),t.H==3&&ui(t)};vt.prototype.N=function(){this.g.h=null,delete this.j,Hs(this.g),delete this.g,vt.$.N.call(this)};function Vl(e){js.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){t:{for(let n in t){e=n;break t}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}tt(Vl,js);function kl(){$s.call(this),this.status=1}tt(kl,$s);function Ye(e){this.g=e}tt(Ye,Dl);Ye.prototype.Ba=function(){it(this.g,"a")};Ye.prototype.Aa=function(e){it(this.g,new Vl(e))};Ye.prototype.za=function(e){it(this.g,new kl)};Ye.prototype.ya=function(){it(this.g,"b")};function rf(){this.blockSize=-1}function Ct(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}tt(Ct,rf);Ct.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function fs(e,t,n){n||(n=0);var r=Array(16);if(typeof t=="string")for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;t=n+(o<<7&4294967295|o>>>25),o=s+(i^t&(n^i))+r[1]+3905402710&4294967295,s=t+(o<<12&4294967295|o>>>20),o=i+(n^s&(t^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(t^i&(s^t))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(s^n&(i^s))+r[4]+4118548399&4294967295,t=n+(o<<7&4294967295|o>>>25),o=s+(i^t&(n^i))+r[5]+1200080426&4294967295,s=t+(o<<12&4294967295|o>>>20),o=i+(n^s&(t^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(t^i&(s^t))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(s^n&(i^s))+r[8]+1770035416&4294967295,t=n+(o<<7&4294967295|o>>>25),o=s+(i^t&(n^i))+r[9]+2336552879&4294967295,s=t+(o<<12&4294967295|o>>>20),o=i+(n^s&(t^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(t^i&(s^t))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(s^n&(i^s))+r[12]+1804603682&4294967295,t=n+(o<<7&4294967295|o>>>25),o=s+(i^t&(n^i))+r[13]+4254626195&4294967295,s=t+(o<<12&4294967295|o>>>20),o=i+(n^s&(t^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(t^i&(s^t))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(i^s&(n^i))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(t^n))+r[6]+3225465664&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^t&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^s&(n^i))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(t^n))+r[10]+38016083&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^t&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^s&(n^i))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(t^n))+r[14]+3275163606&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^t&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^s&(n^i))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(t^n))+r[2]+4243563512&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^t&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(n^i^s)+r[5]+4294588738&4294967295,t=n+(o<<4&4294967295|o>>>28),o=s+(t^n^i)+r[8]+2272392833&4294967295,s=t+(o<<11&4294967295|o>>>21),o=i+(s^t^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^t)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^s)+r[1]+2763975236&4294967295,t=n+(o<<4&4294967295|o>>>28),o=s+(t^n^i)+r[4]+1272893353&4294967295,s=t+(o<<11&4294967295|o>>>21),o=i+(s^t^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^t)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^s)+r[13]+681279174&4294967295,t=n+(o<<4&4294967295|o>>>28),o=s+(t^n^i)+r[0]+3936430074&4294967295,s=t+(o<<11&4294967295|o>>>21),o=i+(s^t^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^t)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^s)+r[9]+3654602809&4294967295,t=n+(o<<4&4294967295|o>>>28),o=s+(t^n^i)+r[12]+3873151461&4294967295,s=t+(o<<11&4294967295|o>>>21),o=i+(s^t^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^t)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(i^(n|~s))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=s+(n^(t|~i))+r[7]+1126891415&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~t))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~s))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=s+(n^(t|~i))+r[3]+2399980690&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~t))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~s))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=s+(n^(t|~i))+r[15]+4264355552&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~t))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~s))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=s+(n^(t|~i))+r[11]+3174756917&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}Ct.prototype.j=function(e,t){t===void 0&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(i==0)for(;s<=n;)fs(this,e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){fs(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){fs(this,r),i=0;break}}this.h=i,this.i+=t};Ct.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=n&255,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};function k(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=e[i]|0;r&&s==t||(n[i]=s,r=!1)}this.g=n}var sf={};function Js(e){return-128<=e&&128>e?pm(e,function(t){return new k([t|0],0>t?-1:0)}):new k([e|0],0>e?-1:0)}function Ft(e){if(isNaN(e)||!isFinite(e))return Qe;if(0>e)return rt(Ft(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=Ps;return new k(t,0)}function Ml(e,t){if(e.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(e.charAt(0)=="-")return rt(Ml(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ft(Math.pow(t,8)),r=Qe,i=0;i<e.length;i+=8){var s=Math.min(8,e.length-i),o=parseInt(e.substring(i,i+s),t);8>s?(s=Ft(Math.pow(t,s)),r=r.R(s).add(Ft(o))):(r=r.R(n),r=r.add(Ft(o)))}return r}var Ps=4294967296,Qe=Js(0),Rs=Js(1),Ru=Js(16777216);p=k.prototype;p.ea=function(){if(Et(this))return-rt(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:Ps+r)*t,t*=Ps}return e};p.toString=function(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(Ht(this))return"0";if(Et(this))return"-"+rt(this).toString(e);for(var t=Ft(Math.pow(e,6)),n=this,r="";;){var i=Wr(n,t).g;n=Qr(n,i.R(t));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(e);if(n=i,Ht(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};p.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h};function Ht(e){if(e.h!=0)return!1;for(var t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function Et(e){return e.h==-1}p.X=function(e){return e=Qr(this,e),Et(e)?-1:Ht(e)?0:1};function rt(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new k(n,~e.h).add(Rs)}p.abs=function(){return Et(this)?rt(this):this};p.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(this.D(i)&65535)+(e.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new k(n,n[n.length-1]&-2147483648?-1:0)};function Qr(e,t){return e.add(rt(t))}p.R=function(e){if(Ht(this)||Ht(e))return Qe;if(Et(this))return Et(e)?rt(this).R(rt(e)):rt(rt(this).R(e));if(Et(e))return rt(this.R(rt(e)));if(0>this.X(Ru)&&0>e.X(Ru))return Ft(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=e.D(i)>>>16,c=e.D(i)&65535;n[2*r+2*i]+=o*c,zr(n,2*r+2*i),n[2*r+2*i+1]+=s*c,zr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,zr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,zr(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new k(n,0)};function zr(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Sn(e,t){this.g=e,this.h=t}function Wr(e,t){if(Ht(t))throw Error("division by zero");if(Ht(e))return new Sn(Qe,Qe);if(Et(e))return t=Wr(rt(e),t),new Sn(rt(t.g),rt(t.h));if(Et(t))return t=Wr(e,rt(t)),new Sn(rt(t.g),t.h);if(30<e.g.length){if(Et(e)||Et(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Rs,r=t;0>=r.X(e);)n=Du(n),r=Du(r);var i=$e(n,1),s=$e(r,1);for(r=$e(r,2),n=$e(n,2);!Ht(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=$e(r,1),n=$e(n,1)}return t=Qr(e,i.R(t)),new Sn(i,t)}for(i=Qe;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ft(n),o=s.R(t);Et(o)||0<o.X(e);)n-=r,s=Ft(n),o=s.R(t);Ht(s)&&(s=Rs),i=i.add(s),e=Qr(e,o)}return new Sn(i,e)}p.gb=function(e){return Wr(this,e).h};p.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new k(n,this.h&e.h)};p.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new k(n,this.h|e.h)};p.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new k(n,this.h^e.h)};function Du(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new k(n,e.h)}function $e(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new k(i,e.h)}Kr.prototype.createWebChannel=Kr.prototype.g;vt.prototype.send=vt.prototype.u;vt.prototype.open=vt.prototype.m;vt.prototype.close=vt.prototype.close;ni.NO_ERROR=0;ni.TIMEOUT=8;ni.HTTP_ERROR=6;Xu.COMPLETE="complete";Ju.EventType=zn;zn.OPEN="a";zn.CLOSE="b";zn.ERROR="c";zn.MESSAGE="d";Z.prototype.listen=Z.prototype.O;q.prototype.listenOnce=q.prototype.P;q.prototype.getLastError=q.prototype.Sa;q.prototype.getLastErrorCode=q.prototype.Ia;q.prototype.getStatus=q.prototype.da;q.prototype.getResponseJson=q.prototype.Wa;q.prototype.getResponseText=q.prototype.ja;q.prototype.send=q.prototype.ha;q.prototype.setWithCredentials=q.prototype.Oa;Ct.prototype.digest=Ct.prototype.l;Ct.prototype.reset=Ct.prototype.reset;Ct.prototype.update=Ct.prototype.j;k.prototype.add=k.prototype.add;k.prototype.multiply=k.prototype.R;k.prototype.modulo=k.prototype.gb;k.prototype.compare=k.prototype.X;k.prototype.toNumber=k.prototype.ea;k.prototype.toString=k.prototype.toString;k.prototype.getBits=k.prototype.D;k.fromNumber=Ft;k.fromString=Ml;var Nl=St.createWebChannelTransport=function(){return new Kr},Ol=St.getStatEventTarget=function(){return ei()},li=St.ErrorCode=ni,Fl=St.EventType=Xu,Ll=St.Event=Ee,Zs=St.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},f_=St.FetchXmlHttpFactory=$n,Wn=St.WebChannel=Ju,ql=St.XhrIo=q,Bl=St.Md5=Ct,be=St.Integer=k;var Ul="@firebase/firestore";var et=class{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}};et.UNAUTHENTICATED=new et(null),et.GOOGLE_CREDENTIALS=new et("google-credentials-uid"),et.FIRST_PARTY=new et("first-party-uid"),et.MOCK_USER=new et("mock-user");var _n="10.8.1";var Re=new Kc("@firebase/firestore");function Hn(){return Re.logLevel}function _(e,...t){if(Re.logLevel<=Wt.DEBUG){let n=t.map(La);Re.debug(`Firestore (${_n}): ${e}`,...n)}}function jt(e,...t){if(Re.logLevel<=Wt.ERROR){let n=t.map(La);Re.error(`Firestore (${_n}): ${e}`,...n)}}function rn(e,...t){if(Re.logLevel<=Wt.WARN){let n=t.map(La);Re.warn(`Firestore (${_n}): ${e}`,...n)}}function La(e){if(typeof e=="string")return e;try{return function(n){return JSON.stringify(n)}(e)}catch{return e}}function T(e="Unexpected state"){let t=`FIRESTORE (${_n}) INTERNAL ASSERTION FAILED: `+e;throw jt(t),new Error(t)}function O(e,t){e||T()}function C(e,t){return e}var m={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},v=class extends jc{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Bt=class{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}};var gi=class{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}},io=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(et.UNAUTHENTICATED))}shutdown(){}},so=class{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},oo=class{constructor(t){this.t=t,this.currentUser=et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new Bt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Bt,t.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;t.enqueueRetryable(()=>y(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{_("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(_("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Bt)}},0),o()}getToken(){let t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(_("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(O(typeof r.accessToken=="string"),new gi(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let t=this.auth&&this.auth.getUid();return O(t===null||typeof t=="string"),new et(t)}},ao=class{constructor(t,n,r){this.l=t,this.h=n,this.P=r,this.type="FirstParty",this.user=et.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},co=class{constructor(t,n,r){this.l=t,this.h=n,this.P=r}getToken(){return Promise.resolve(new ao(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(et.FIRST_PARTY))}shutdown(){}invalidateToken(){}},uo=class{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},lo=class{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,n){let r=s=>{s.error!=null&&_("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,_("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>r(s))};let i=s=>{_("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):_("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(O(typeof n.token=="string"),this.R=n.token,new uo(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function of(e){let t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var pi=class{static newId(){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length,r="";for(;r.length<20;){let i=of(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=t.charAt(i[s]%t.length))}return r}};function V(e,t){return e<t?-1:e>t?1:0}function sn(e,t,n){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}var Q=class e{constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new v(m.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new v(m.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new v(m.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new v(m.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return e.fromMillis(Date.now())}static fromDate(t){return e.fromMillis(t.getTime())}static fromMillis(t){let n=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*n));return new e(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?V(this.nanoseconds,t.nanoseconds):V(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var A=class e{constructor(t){this.timestamp=t}static fromTimestamp(t){return new e(t)}static min(){return new e(new Q(0,0))}static max(){return new e(new Q(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var _i=class e{constructor(t,n,r){n===void 0?n=0:n>t.length&&T(),r===void 0?r=t.length-n:r>t.length-n&&T(),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return e.comparator(this,t)===0}child(t){let n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){let r=Math.min(t.length,n.length);for(let i=0;i<r;i++){let s=t.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return t.length<n.length?-1:t.length>n.length?1:0}},U=class e extends _i{construct(t,n,r){return new e(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){let n=[];for(let r of t){if(r.indexOf("//")>=0)throw new v(m.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new e(n)}static emptyPath(){return new e([])}},af=/^[_a-zA-Z][_a-zA-Z0-9]*$/,wt=class e extends _i{construct(t,n,r){return new e(t,n,r)}static isValidIdentifier(t){return af.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new e(["__name__"])}static fromServerFormat(t){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new v(m.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<t.length;){let a=t[i];if(a==="\\"){if(i+1===t.length)throw new v(m.INVALID_ARGUMENT,"Path has trailing escape character: "+t);let c=t[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new v(m.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new v(m.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)}static emptyPath(){return new e([])}};var I=class e{constructor(t){this.path=t}static fromPath(t){return new e(U.fromString(t))}static fromName(t){return new e(U.fromString(t).popFirst(5))}static empty(){return new e(U.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&U.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return U.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new e(new U(t.slice()))}};var ho=class{constructor(t,n,r,i){this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i}};ho.UNKNOWN_ID=-1;function cf(e,t){let n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=A.fromTimestamp(r===1e9?new Q(n+1,0):new Q(n,r));return new De(i,I.empty(),t)}function uf(e){return new De(e.readTime,e.key,-1)}var De=class e{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new e(A.min(),I.empty(),-1)}static max(){return new e(A.max(),I.empty(),-1)}};function lf(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=I.comparator(e.documentKey,t.documentKey),n!==0?n:V(e.largestBatchId,t.largestBatchId))}var hf="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",mo=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}};function dr(e){return y(this,null,function*(){if(e.code!==m.FAILED_PRECONDITION||e.message!==hf)throw e;_("LocalStore","Unexpectedly lost primary lease")})}var f=class e{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&T(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{let n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):e.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):e.reject(n)}static resolve(t){return new e((n,r)=>{n(t)})}static reject(t){return new e((n,r)=>{r(t)})}static waitFor(t){return new e((n,r)=>{let i=0,s=0,o=!1;t.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(t){let n=e.resolve(!1);for(let r of t)n=n.next(i=>i?e.resolve(i):r());return n}static forEach(t,n){let r=[];return t.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(t,n){return new e((r,i)=>{let s=t.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(t[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(t,n){return new e((r,i)=>{let s=()=>{t()===!0?n().next(()=>{s()},i):r()};s()})}};var fo=class e{constructor(t,n){this.action=t,this.transaction=n,this.aborted=!1,this.V=new Bt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Pe(t,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=qa(r.target.error);this.V.reject(new Pe(t,i))}}static open(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(s){throw new Pe(n,s)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(_("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){let n=this.transaction.objectStore(t);return new po(n)}},yi=class e{constructor(t,n,r){this.name=t,this.version=n,this.p=r,e.S(bn())===12.2&&jt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return _("SimpleDb","Removing database:",t),Ae(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!Gc())return!1;if(e.C())return!0;let t=bn(),n=e.S(t),r=0<n&&n<10,i=e.v(t),s=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||s)}static C(){var t;return typeof process<"u"&&((t=process.__PRIVATE_env)===null||t===void 0?void 0:t.F)==="YES"}static M(t,n){return t.store(n)}static S(t){let n=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(t){let n=t.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(t){return y(this,null,function*(){return this.db||(_("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Pe(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new v(m.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new v(m.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Pe(t,o))},i.onupgradeneeded=s=>{_("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{_("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(t){this.B=t,this.db&&(this.db.onversionchange=n=>t(n))}runTransaction(t,n,r,i){return y(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(t);let a=fo.open(this.db,t,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),f.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(_("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},go=class{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Ae(this.k.delete())}},Pe=class extends v{constructor(t,n){super(m.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function mr(e){return e.name==="IndexedDbTransactionError"}var po=class{constructor(t){this.store=t}put(t,n){let r;return n!==void 0?(_("SimpleDb","PUT",this.store.name,t,n),r=this.store.put(n,t)):(_("SimpleDb","PUT",this.store.name,"<auto-key>",t),r=this.store.put(t)),Ae(r)}add(t){return _("SimpleDb","ADD",this.store.name,t,t),Ae(this.store.add(t))}get(t){return Ae(this.store.get(t)).next(n=>(n===void 0&&(n=null),_("SimpleDb","GET",this.store.name,t,n),n))}delete(t){return _("SimpleDb","DELETE",this.store.name,t),Ae(this.store.delete(t))}count(){return _("SimpleDb","COUNT",this.store.name),Ae(this.store.count())}W(t,n){let r=this.options(t,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new f((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(t,n){let r=this.store.getAll(t,n===null?void 0:n);return new f((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(t,n){_("SimpleDb","DELETE ALL",this.store.name);let r=this.options(t,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(t,n){let r;n?r=t:(r={},n=t);let i=this.cursor(r);return this.G(i,n)}Z(t){let n=this.cursor({});return new f((r,i)=>{n.onerror=s=>{let o=qa(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?t(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(t,n){let r=[];return new f((i,s)=>{t.onerror=o=>{s(o.target.error)},t.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new go(a),u=n(a.primaryKey,a.value,c);if(u instanceof f){let l=u.catch(h=>(c.done(),f.reject(h)));r.push(l)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>f.waitFor(r))}options(t,n){let r;return t!==void 0&&(typeof t=="string"?r=t:n=t),{index:r,range:n}}cursor(t){let n="next";if(t.reverse&&(n="prev"),t.index){let r=this.store.index(t.index);return t.J?r.openKeyCursor(t.range,n):r.openCursor(t.range,n)}return this.store.openCursor(t.range,n)}};function Ae(e){return new f((t,n)=>{e.onsuccess=r=>{let i=r.target.result;t(i)},e.onerror=r=>{let i=qa(r.target.error);n(i)}})}var zl=!1;function qa(e){let t=yi.S(bn());if(t>=12.2&&t<13){let n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){let r=new v("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return zl||(zl=!0,setTimeout(()=>{throw r},0)),r}}return e}var _h=(()=>{class e{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return e._e=-1,e})();function Ki(e){return e==null}function er(e){return e===0&&1/e==-1/0}function df(e){return typeof e=="number"&&Number.isInteger(e)&&!er(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var mf=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],C_=[...mf,"documentOverlays"],ff=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],gf=ff,S_=[...gf,"indexConfiguration","indexState","indexEntries"];function Gl(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function yn(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function yh(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var z=class e{constructor(t,n){this.comparator=t,this.root=n||Ut.EMPTY}insert(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ut.BLACK,null,null))}remove(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ut.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){let t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new tn(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new tn(this.root,t,this.comparator,!1)}getReverseIterator(){return new tn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new tn(this.root,t,this.comparator,!0)}},tn=class{constructor(t,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop(),n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}},Ut=class e{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??e.RED,this.left=i??e.EMPTY,this.right=s??e.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,s){return new e(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this,s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return e.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw T();let t=this.left.check();if(t!==this.right.check())throw T();return t+(this.isRed()?0:1)}};Ut.EMPTY=null,Ut.RED=!0,Ut.BLACK=!1;Ut.EMPTY=new class{constructor(){this.size=0}get key(){throw T()}get value(){throw T()}get color(){throw T()}get left(){throw T()}get right(){throw T()}copy(t,n,r,i,s){return this}insert(t,n,r){return new Ut(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ut=class e{constructor(t){this.comparator=t,this.data=new z(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){let r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){let n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new vi(this.data.getIterator())}getIteratorFrom(t){return new vi(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let t=[];return this.forEach(n=>{t.push(n)}),t}toString(){let t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){let n=new e(this.comparator);return n.data=t,n}},vi=class{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var qt=class e{constructor(t){this.fields=t,t.sort(wt.comparator)}static empty(){return new e([])}unionWith(t){let n=new ut(wt.comparator);for(let r of this.fields)n=n.add(r);for(let r of t)n=n.add(r);return new e(n.toArray())}covers(t){for(let n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return sn(this.fields,t.fields,(n,r)=>n.isEqual(r))}};var wi=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ht=class e{constructor(t){this.binaryString=t}static fromBase64String(t){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new wi("Invalid base64 string: "+s):s}}(t);return new e(n)}static fromUint8Array(t){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new e(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return V(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}};ht.EMPTY_BYTE_STRING=new ht("");var pf=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ue(e){if(O(!!e),typeof e=="string"){let t=0,n=pf.exec(e);if(O(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),t=Number(i)}let r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:B(e.seconds),nanos:B(e.nanos)}}function B(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function le(e){return typeof e=="string"?ht.fromBase64String(e):ht.fromUint8Array(e)}function Ba(e){var t,n;return((n=(((t=e?.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Ua(e){let t=e.mapValue.fields.__previous_value__;return Ba(t)?Ua(t):t}function nr(e){let t=ue(e.mapValue.fields.__local_write_time__.timestampValue);return new Q(t.seconds,t.nanos)}var _o=class{constructor(t,n,r,i,s,o,a,c,u){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},Ii=class e{constructor(t,n){this.projectId=t,this.database=n||"(default)"}static empty(){return new e("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}};var hi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ve(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ba(e)?4:vh(e)?9007199254740991:10:T()}function $t(e,t){if(e===t)return!0;let n=Ve(e);if(n!==Ve(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return nr(e).isEqual(nr(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=ue(i.timestampValue),a=ue(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return le(i.bytesValue).isEqual(le(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return B(i.geoPointValue.latitude)===B(s.geoPointValue.latitude)&&B(i.geoPointValue.longitude)===B(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return B(i.integerValue)===B(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=B(i.doubleValue),a=B(s.doubleValue);return o===a?er(o)===er(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return sn(e.arrayValue.values||[],t.arrayValue.values||[],$t);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Gl(o)!==Gl(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!$t(o[c],a[c])))return!1;return!0}(e,t);default:return T()}}function rr(e,t){return(e.values||[]).find(n=>$t(n,t))!==void 0}function on(e,t){if(e===t)return 0;let n=Ve(e),r=Ve(t);if(n!==r)return V(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return V(e.booleanValue,t.booleanValue);case 2:return function(s,o){let a=B(s.integerValue||s.doubleValue),c=B(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(e,t);case 3:return jl(e.timestampValue,t.timestampValue);case 4:return jl(nr(e),nr(t));case 5:return V(e.stringValue,t.stringValue);case 6:return function(s,o){let a=le(s),c=le(o);return a.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=V(a[u],c[u]);if(l!==0)return l}return V(a.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){let a=V(B(s.latitude),B(o.latitude));return a!==0?a:V(B(s.longitude),B(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=on(a[u],c[u]);if(l)return l}return V(a.length,c.length)}(e.arrayValue,t.arrayValue);case 10:return function(s,o){if(s===hi.mapValue&&o===hi.mapValue)return 0;if(s===hi.mapValue)return 1;if(o===hi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let h=0;h<c.length&&h<l.length;++h){let d=V(c[h],l[h]);if(d!==0)return d;let g=on(a[c[h]],u[l[h]]);if(g!==0)return g}return V(c.length,l.length)}(e.mapValue,t.mapValue);default:throw T()}}function jl(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return V(e,t);let n=ue(e),r=ue(t),i=V(n.seconds,r.seconds);return i!==0?i:V(n.nanos,r.nanos)}function an(e){return yo(e)}function yo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){let r=ue(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return le(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return I.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=yo(s);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${yo(n.fields[o])}`;return i+"}"}(e.mapValue):T()}function vo(e){return!!e&&"integerValue"in e}function za(e){return!!e&&"arrayValue"in e}function $l(e){return!!e&&"nullValue"in e}function Kl(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function mi(e){return!!e&&"mapValue"in e}function Xn(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){let t={mapValue:{fields:{}}};return yn(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=Xn(r)),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Xn(e.arrayValue.values[n]);return t}return Object.assign({},e)}function vh(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var xt=class e{constructor(t){this.value=t}static empty(){return new e({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!mi(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Xn(n)}setAll(t){let n=wt.emptyPath(),r={},i=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Xn(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(t){let n=this.field(t.popLast());mi(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return $t(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=n.mapValue.fields[t.get(r)];mi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(t,n,r){yn(n,(i,s)=>t[i]=s);for(let i of r)delete t[i]}clone(){return new e(Xn(this.value))}};function wh(e){let t=[];return yn(e.fields,(n,r)=>{let i=new wt([n]);if(mi(r)){let s=wh(r.mapValue).fields;if(s.length===0)t.push(i);else for(let o of s)t.push(i.child(o))}else t.push(i)}),new qt(t)}var Pt=class e{constructor(t,n,r,i,s,o,a){this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(t){return new e(t,0,A.min(),A.min(),A.min(),xt.empty(),0)}static newFoundDocument(t,n,r,i){return new e(t,1,n,A.min(),r,i,0)}static newNoDocument(t,n){return new e(t,2,n,A.min(),A.min(),xt.empty(),0)}static newUnknownDocument(t,n){return new e(t,3,n,A.min(),A.min(),xt.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(A.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=xt.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=A.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var cn=class{constructor(t,n){this.position=t,this.inclusive=n}};function Ql(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){let s=t[i],o=e.position[i];if(s.field.isKeyField()?r=I.comparator(I.fromName(o.referenceValue),n.key):r=on(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Wl(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!$t(e.position[n],t.position[n]))return!1;return!0}var un=class{constructor(t,n="asc"){this.field=t,this.dir=n}};function _f(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var Ti=class{},Y=class e extends Ti{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new Io(t,n,r):n==="array-contains"?new bo(t,r):n==="in"?new Ao(t,r):n==="not-in"?new Co(t,r):n==="array-contains-any"?new So(t,r):new e(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new To(t,r):new Eo(t,r)}matches(t){let n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(on(n,this.value)):n!==null&&Ve(this.value)===Ve(n)&&this.matchesComparison(on(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return T()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Kt=class e extends Ti{constructor(t,n){super(),this.filters=t,this.op=n,this.ue=null}static create(t,n){return new e(t,n)}matches(t){return Ih(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Ih(e){return e.op==="and"}function Th(e){return yf(e)&&Ih(e)}function yf(e){for(let t of e.filters)if(t instanceof Kt)return!1;return!0}function wo(e){if(e instanceof Y)return e.field.canonicalString()+e.op.toString()+an(e.value);if(Th(e))return e.filters.map(t=>wo(t)).join(",");{let t=e.filters.map(n=>wo(n)).join(",");return`${e.op}(${t})`}}function Eh(e,t){return e instanceof Y?function(r,i){return i instanceof Y&&r.op===i.op&&r.field.isEqual(i.field)&&$t(r.value,i.value)}(e,t):e instanceof Kt?function(r,i){return i instanceof Kt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Eh(o,i.filters[a]),!0):!1}(e,t):void T()}function bh(e){return e instanceof Y?function(n){return`${n.field.canonicalString()} ${n.op} ${an(n.value)}`}(e):e instanceof Kt?function(n){return n.op.toString()+" {"+n.getFilters().map(bh).join(" ,")+"}"}(e):"Filter"}var Io=class extends Y{constructor(t,n,r){super(t,n,r),this.key=I.fromName(r.referenceValue)}matches(t){let n=I.comparator(t.key,this.key);return this.matchesComparison(n)}},To=class extends Y{constructor(t,n){super(t,"in",n),this.keys=Ah("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}},Eo=class extends Y{constructor(t,n){super(t,"not-in",n),this.keys=Ah("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}};function Ah(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>I.fromName(r.referenceValue))}var bo=class extends Y{constructor(t,n){super(t,"array-contains",n)}matches(t){let n=t.data.field(this.field);return za(n)&&rr(n.arrayValue,this.value)}},Ao=class extends Y{constructor(t,n){super(t,"in",n)}matches(t){let n=t.data.field(this.field);return n!==null&&rr(this.value.arrayValue,n)}},Co=class extends Y{constructor(t,n){super(t,"not-in",n)}matches(t){if(rr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=t.data.field(this.field);return n!==null&&!rr(this.value.arrayValue,n)}},So=class extends Y{constructor(t,n){super(t,"array-contains-any",n)}matches(t){let n=t.data.field(this.field);return!(!za(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>rr(this.value.arrayValue,r))}};var xo=class{constructor(t,n=null,r=[],i=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function Hl(e,t=null,n=[],r=[],i=null,s=null,o=null){return new xo(e,t,n,r,i,s,o)}function Ga(e){let t=C(e);if(t.ce===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>wo(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ki(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>an(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>an(r)).join(",")),t.ce=n}return t.ce}function ja(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!_f(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Eh(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Wl(e.startAt,t.startAt)&&Wl(e.endAt,t.endAt)}function Po(e){return I.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}var ln=class{constructor(t,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function vf(e,t,n,r,i,s,o,a){return new ln(e,t,n,r,i,s,o,a)}function $a(e){return new ln(e)}function Yl(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function wf(e){return e.collectionGroup!==null}function Jn(e){let t=C(e);if(t.le===null){t.le=[];let n=new Set;for(let s of t.explicitOrderBy)t.le.push(s),n.add(s.field.canonicalString());let r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ut(wt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.le.push(new un(s,r))}),n.has(wt.keyField().canonicalString())||t.le.push(new un(wt.keyField(),r))}return t.le}function zt(e){let t=C(e);return t.he||(t.he=If(t,Jn(e))),t.he}function If(e,t){if(e.limitType==="F")return Hl(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new un(i.field,s)});let n=e.endAt?new cn(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new cn(e.startAt.position,e.startAt.inclusive):null;return Hl(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Ro(e,t,n){return new ln(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Qi(e,t){return ja(zt(e),zt(t))&&e.limitType===t.limitType}function Ch(e){return`${Ga(zt(e))}|lt:${e.limitType}`}function Xe(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>bh(i)).join(", ")}]`),Ki(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>an(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>an(i)).join(",")),`Target(${r})`}(zt(e))}; limitType=${e.limitType})`}function Wi(e,t){return t.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):I.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(e,t)&&function(r,i){for(let s of Jn(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=Ql(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,Jn(r),i)||r.endAt&&!function(o,a,c){let u=Ql(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,Jn(r),i))}(e,t)}function Tf(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Sh(e){return(t,n)=>{let r=!1;for(let i of Jn(e)){let s=Ef(i,t,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Ef(e,t,n){let r=e.field.isKeyField()?I.comparator(t.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?on(c,u):T()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return T()}}var he=class{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){let n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){let r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,n]);i.push([t,n]),this.innerSize++}delete(t){let n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){yn(this.inner,(n,r)=>{for(let[i,s]of r)t(i,s)})}isEmpty(){return yh(this.inner)}size(){return this.innerSize}};var bf=new z(I.comparator);function Jt(){return bf}var xh=new z(I.comparator);function Yn(...e){let t=xh;for(let n of e)t=t.insert(n.key,n);return t}function Ph(e){let t=xh;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function Ce(){return Zn()}function Rh(){return Zn()}function Zn(){return new he(e=>e.toString(),(e,t)=>e.isEqual(t))}var Af=new z(I.comparator),Cf=new ut(I.comparator);function P(...e){let t=Cf;for(let n of e)t=t.add(n);return t}var Sf=new ut(V);function xf(){return Sf}function Dh(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:er(t)?"-0":t}}function Vh(e){return{integerValue:""+e}}function Pf(e,t){return df(t)?Vh(t):Dh(e,t)}var hn=class{constructor(){this._=void 0}};function Rf(e,t,n){return e instanceof dn?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ba(s)&&(s=Ua(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,t):e instanceof ke?Mh(e,t):e instanceof Me?Nh(e,t):function(i,s){let o=kh(i,s),a=Xl(o)+Xl(i.Ie);return vo(o)&&vo(i.Ie)?Vh(a):Dh(i.serializer,a)}(e,t)}function Df(e,t,n){return e instanceof ke?Mh(e,t):e instanceof Me?Nh(e,t):n}function kh(e,t){return e instanceof mn?function(r){return vo(r)||function(s){return!!s&&"doubleValue"in s}(r)}(t)?t:{integerValue:0}:null}var dn=class extends hn{},ke=class extends hn{constructor(t){super(),this.elements=t}};function Mh(e,t){let n=Oh(t);for(let r of e.elements)n.some(i=>$t(i,r))||n.push(r);return{arrayValue:{values:n}}}var Me=class extends hn{constructor(t){super(),this.elements=t}};function Nh(e,t){let n=Oh(t);for(let r of e.elements)n=n.filter(i=>!$t(i,r));return{arrayValue:{values:n}}}var mn=class extends hn{constructor(t,n){super(),this.serializer=t,this.Ie=n}};function Xl(e){return B(e.integerValue||e.doubleValue)}function Oh(e){return za(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function Vf(e,t){return e.field.isEqual(t.field)&&function(r,i){return r instanceof ke&&i instanceof ke||r instanceof Me&&i instanceof Me?sn(r.elements,i.elements,$t):r instanceof mn&&i instanceof mn?$t(r.Ie,i.Ie):r instanceof dn&&i instanceof dn}(e.transform,t.transform)}var Do=class{constructor(t,n){this.version=t,this.transformResults=n}},Xt=class e{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new e}static exists(t){return new e(void 0,t)}static updateTime(t){return new e(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}};function fi(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}var fn=class{};function Fh(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new ir(e.key,Xt.none()):new Ne(e.key,e.data,Xt.none());{let n=e.data,r=xt.empty(),i=new ut(wt.comparator);for(let s of t.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Zt(e.key,r,new qt(i.toArray()),Xt.none())}}function kf(e,t,n){e instanceof Ne?function(i,s,o){let a=i.value.clone(),c=Zl(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof Zt?function(i,s,o){if(!fi(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=Zl(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Lh(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(e,t,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function tr(e,t,n,r){return e instanceof Ne?function(s,o,a,c){if(!fi(s.precondition,o))return a;let u=s.value.clone(),l=th(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(e,t,n,r):e instanceof Zt?function(s,o,a,c){if(!fi(s.precondition,o))return a;let u=th(s.fieldTransforms,c,o),l=o.data;return l.setAll(Lh(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(e,t,n,r):function(s,o,a){return fi(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function Mf(e,t){let n=null;for(let r of e.fieldTransforms){let i=t.data.field(r.field),s=kh(r.transform,i||null);s!=null&&(n===null&&(n=xt.empty()),n.set(r.field,s))}return n||null}function Jl(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&sn(r,i,(s,o)=>Vf(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Ne=class extends fn{constructor(t,n,r,i=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Zt=class extends fn{constructor(t,n,r,i,s=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Lh(e){let t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=e.data.field(n);t.set(n,r)}}),t}function Zl(e,t,n){let r=new Map;O(e.length===n.length);for(let i=0;i<n.length;i++){let s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Df(o,a,n[i]))}return r}function th(e,t,n){let r=new Map;for(let i of e){let s=i.transform,o=n.data.field(i.field);r.set(i.field,Rf(s,o,t))}return r}var ir=class extends fn{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Vo=class extends fn{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ko=class{constructor(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(t.key)&&kf(s,t,r[i])}}applyToLocalView(t,n){for(let r of this.baseMutations)r.key.isEqual(t.key)&&(n=tr(r,t,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(t.key)&&(n=tr(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){let r=Rh();return this.mutations.forEach(i=>{let s=t.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=Fh(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(A.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),P())}isEqual(t){return this.batchId===t.batchId&&sn(this.mutations,t.mutations,(n,r)=>Jl(n,r))&&sn(this.baseMutations,t.baseMutations,(n,r)=>Jl(n,r))}},Mo=class e{constructor(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(t,n,r){O(t.mutations.length===r.length);let i=function(){return Af}(),s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new e(t,n,r,i)}};var No=class{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Oo=class{constructor(t,n){this.count=t,this.unchangedNames=n}};var $,R;function Nf(e){switch(e){default:return T();case m.CANCELLED:case m.UNKNOWN:case m.DEADLINE_EXCEEDED:case m.RESOURCE_EXHAUSTED:case m.INTERNAL:case m.UNAVAILABLE:case m.UNAUTHENTICATED:return!1;case m.INVALID_ARGUMENT:case m.NOT_FOUND:case m.ALREADY_EXISTS:case m.PERMISSION_DENIED:case m.FAILED_PRECONDITION:case m.ABORTED:case m.OUT_OF_RANGE:case m.UNIMPLEMENTED:case m.DATA_LOSS:return!0}}function qh(e){if(e===void 0)return jt("GRPC error has no .code"),m.UNKNOWN;switch(e){case $.OK:return m.OK;case $.CANCELLED:return m.CANCELLED;case $.UNKNOWN:return m.UNKNOWN;case $.DEADLINE_EXCEEDED:return m.DEADLINE_EXCEEDED;case $.RESOURCE_EXHAUSTED:return m.RESOURCE_EXHAUSTED;case $.INTERNAL:return m.INTERNAL;case $.UNAVAILABLE:return m.UNAVAILABLE;case $.UNAUTHENTICATED:return m.UNAUTHENTICATED;case $.INVALID_ARGUMENT:return m.INVALID_ARGUMENT;case $.NOT_FOUND:return m.NOT_FOUND;case $.ALREADY_EXISTS:return m.ALREADY_EXISTS;case $.PERMISSION_DENIED:return m.PERMISSION_DENIED;case $.FAILED_PRECONDITION:return m.FAILED_PRECONDITION;case $.ABORTED:return m.ABORTED;case $.OUT_OF_RANGE:return m.OUT_OF_RANGE;case $.UNIMPLEMENTED:return m.UNIMPLEMENTED;case $.DATA_LOSS:return m.DATA_LOSS;default:return T()}}(R=$||($={}))[R.OK=0]="OK",R[R.CANCELLED=1]="CANCELLED",R[R.UNKNOWN=2]="UNKNOWN",R[R.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",R[R.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",R[R.NOT_FOUND=5]="NOT_FOUND",R[R.ALREADY_EXISTS=6]="ALREADY_EXISTS",R[R.PERMISSION_DENIED=7]="PERMISSION_DENIED",R[R.UNAUTHENTICATED=16]="UNAUTHENTICATED",R[R.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",R[R.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",R[R.ABORTED=10]="ABORTED",R[R.OUT_OF_RANGE=11]="OUT_OF_RANGE",R[R.UNIMPLEMENTED=12]="UNIMPLEMENTED",R[R.INTERNAL=13]="INTERNAL",R[R.UNAVAILABLE=14]="UNAVAILABLE",R[R.DATA_LOSS=15]="DATA_LOSS";var eh=null;function Of(){return new TextEncoder}var Ff=new be([4294967295,4294967295],0);function nh(e){let t=Of().encode(e),n=new Bl;return n.update(t),new Uint8Array(n.digest())}function rh(e){let t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new be([n,r],0),new be([i,s],0)]}var Fo=class e{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Se(`Invalid padding: ${n}`);if(r<0)throw new Se(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Se(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Se(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*t.length-n,this.Ee=be.fromNumber(this.Te)}de(t,n,r){let i=t.add(n.multiply(be.fromNumber(r)));return i.compare(Ff)===1&&(i=new be([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;let n=nh(t),[r,i]=rh(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(t,n,r){let i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new e(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(t){if(this.Te===0)return;let n=nh(t),[r,i]=rh(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(t){let n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}},Se=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ei=class e{constructor(t,n,r,i,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,r){let i=new Map;return i.set(t,sr.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(A.min(),i,new z(V),Jt(),P())}},sr=class e{constructor(t,n,r,i,s){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new e(r,n,P(),P(),P())}};var en=class{constructor(t,n,r,i){this.Ve=t,this.removedTargetIds=n,this.key=r,this.me=i}},bi=class{constructor(t,n){this.targetId=t,this.fe=n}},Ai=class{constructor(t,n,r=ht.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}},Ci=class{constructor(){this.ge=0,this.pe=sh(),this.ye=ht.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=P(),n=P(),r=P();return this.pe.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:T()}}),new sr(this.ye,this.we,t,n,r)}Fe(){this.Se=!1,this.pe=sh()}Me(t,n){this.Se=!0,this.pe=this.pe.insert(t,n)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,O(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},Lo=class{constructor(t){this.Le=t,this.ke=new Map,this.qe=Jt(),this.Qe=ih(),this.Ke=new z(V)}$e(t){for(let n of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(n,t.me):this.We(n,t.key,t.me);for(let n of t.removedTargetIds)this.We(n,t.key,t.me)}Ge(t){this.forEachTarget(t,n=>{let r=this.ze(n);switch(t.state){case 0:this.je(n)&&r.Ce(t.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(t.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(t.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(t.resumeToken));break;default:T()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(t){let n=t.targetId,r=t.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Po(s))if(r===0){let o=new I(s.path);this.We(n,o,Pt.newNoDocument(o,A.min()))}else O(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(t),c=a?this.et(a,t,o):1;if(c!==0){this.He(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}eh?.tt(function(l,h,d,g,S){var b,w,M,G,nt,_t;let fe={localCacheCount:l,existenceFilterCount:h.count,databaseId:d.database,projectId:d.projectId},dt=h.unchangedNames;return dt&&(fe.bloomFilter={applied:S===0,hashCount:(b=dt?.hashCount)!==null&&b!==void 0?b:0,bitmapLength:(G=(M=(w=dt?.bits)===null||w===void 0?void 0:w.bitmap)===null||M===void 0?void 0:M.length)!==null&&G!==void 0?G:0,padding:(_t=(nt=dt?.bits)===null||nt===void 0?void 0:nt.padding)!==null&&_t!==void 0?_t:0,mightContain:Le=>{var pr;return(pr=g?.mightContain(Le))!==null&&pr!==void 0&&pr}}),fe}(o,t.fe,this.Le.nt(),a,c))}}}}Xe(t){let n=t.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=le(r).toUint8Array()}catch(c){if(c instanceof wi)return rn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Fo(o,i,s)}catch(c){return rn(c instanceof Se?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(t,n,r){return n.fe.count===r-this.rt(t,n.targetId)?0:2}rt(t,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(a)||(this.We(n,s,null),i++)}),i}it(t){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Po(a.target)){let c=new I(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,Pt.newNoDocument(c,t))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=P();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(t));let i=new Ei(t,n,this.Ke,this.qe,r);return this.qe=Jt(),this.Qe=ih(),this.Ke=new z(V),i}Ue(t,n){if(!this.je(t))return;let r=this.st(t,n.key)?2:0;this.ze(t).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(t))}We(t,n,r){if(!this.je(t))return;let i=this.ze(t);this.st(t,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(t)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(t){this.ke.delete(t)}Ze(t){let n=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let n=this.ke.get(t);return n||(n=new Ci,this.ke.set(t,n)),n}ot(t){let n=this.Qe.get(t);return n||(n=new ut(V),this.Qe=this.Qe.insert(t,n)),n}je(t){let n=this.Ye(t)!==null;return n||_("WatchChangeAggregator","Detected inactive target",t),n}Ye(t){let n=this.ke.get(t);return n&&n.be?null:this.Le._t(t)}He(t){this.ke.set(t,new Ci),this.Le.getRemoteKeysForTarget(t).forEach(n=>{this.We(t,n,null)})}st(t,n){return this.Le.getRemoteKeysForTarget(t).has(n)}};function ih(){return new z(I.comparator)}function sh(){return new z(I.comparator)}var Lf={asc:"ASCENDING",desc:"DESCENDING"},qf={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bf={and:"AND",or:"OR"},qo=class{constructor(t,n){this.databaseId=t,this.useProto3Json=n}};function Bo(e,t){return e.useProto3Json||Ki(t)?t:{value:t}}function Si(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Bh(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Uf(e,t){return Si(e,t.toTimestamp())}function Gt(e){return O(!!e),A.fromTimestamp(function(n){let r=ue(n);return new Q(r.seconds,r.nanos)}(e))}function Ka(e,t){return Uo(e,t).canonicalString()}function Uo(e,t){let n=function(i){return new U(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Uh(e){let t=U.fromString(e);return O(Kh(t)),t}function zo(e,t){return Ka(e.databaseId,t.path)}function to(e,t){let n=Uh(t);if(n.get(1)!==e.databaseId.projectId)throw new v(m.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new v(m.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new I(Gh(n))}function zh(e,t){return Ka(e.databaseId,t)}function zf(e){let t=Uh(e);return t.length===4?U.emptyPath():Gh(t)}function Go(e){return new U(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Gh(e){return O(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function oh(e,t,n){return{name:zo(e,t),fields:n.value.mapValue.fields}}function Gf(e,t){let n;if("targetChange"in t){t.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:T()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(u,l){return u.useProto3Json?(O(l===void 0||typeof l=="string"),ht.fromBase64String(l||"")):(O(l===void 0||l instanceof Uint8Array),ht.fromUint8Array(l||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(u){let l=u.code===void 0?m.UNKNOWN:qh(u.code);return new v(l,u.message||"")}(o);n=new Ai(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;let r=t.documentChange;r.document,r.document.name,r.document.updateTime;let i=to(e,r.document.name),s=Gt(r.document.updateTime),o=r.document.createTime?Gt(r.document.createTime):A.min(),a=new xt({mapValue:{fields:r.document.fields}}),c=Pt.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new en(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;let r=t.documentDelete;r.document;let i=to(e,r.document),s=r.readTime?Gt(r.readTime):A.min(),o=Pt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new en([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;let r=t.documentRemove;r.document;let i=to(e,r.document),s=r.removedTargetIds||[];n=new en([],s,i,null)}else{if(!("filter"in t))return T();{t.filter;let r=t.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new Oo(i,s),a=r.targetId;n=new bi(a,o)}}return n}function jf(e,t){let n;if(t instanceof Ne)n={update:oh(e,t.key,t.value)};else if(t instanceof ir)n={delete:zo(e,t.key)};else if(t instanceof Zt)n={update:oh(e,t.key,t.data),updateMask:Zf(t.fieldMask)};else{if(!(t instanceof Vo))return T();n={verify:zo(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof dn)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ke)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Me)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof mn)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw T()}(0,r))),t.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Uf(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:T()}(e,t.precondition)),n}function $f(e,t){return e&&e.length>0?(O(t!==void 0),e.map(n=>function(i,s){let o=i.updateTime?Gt(i.updateTime):Gt(s);return o.isEqual(A.min())&&(o=Gt(s)),new Do(o,i.transformResults||[])}(n,t))):[]}function Kf(e,t){return{documents:[zh(e,t.path)]}}function Qf(e,t){let n={structuredQuery:{}},r=t.path,i;t.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=zh(e,i);let s=function(u){if(u.length!==0)return $h(Kt.create(u,"and"))}(t.filters);s&&(n.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(l=>function(d){return{field:Je(d.field),direction:Yf(d.dir)}}(l))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);let a=Bo(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(t.endAt)),{ut:n,parent:i}}function Wf(e){let t=zf(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){O(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:t=t.child(l.collectionId)}let s=[];n.where&&(s=function(h){let d=jh(h);return d instanceof Kt&&Th(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(d=>function(S){return new un(Ze(S.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(d))}(n.orderBy));let a=null;n.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,Ki(d)?null:d}(n.limit));let c=null;n.startAt&&(c=function(h){let d=!!h.before,g=h.values||[];return new cn(g,d)}(n.startAt));let u=null;return n.endAt&&(u=function(h){let d=!h.before,g=h.values||[];return new cn(g,d)}(n.endAt)),vf(t,i,o,s,a,"F",c,u)}function Hf(e,t){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return T()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function jh(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Ze(n.unaryFilter.field);return Y.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ze(n.unaryFilter.field);return Y.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ze(n.unaryFilter.field);return Y.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Ze(n.unaryFilter.field);return Y.create(o,"!=",{nullValue:"NULL_VALUE"});default:return T()}}(e):e.fieldFilter!==void 0?function(n){return Y.create(Ze(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return T()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Kt.create(n.compositeFilter.filters.map(r=>jh(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return T()}}(n.compositeFilter.op))}(e):T()}function Yf(e){return Lf[e]}function Xf(e){return qf[e]}function Jf(e){return Bf[e]}function Je(e){return{fieldPath:e.canonicalString()}}function Ze(e){return wt.fromServerFormat(e.fieldPath)}function $h(e){return e instanceof Y?function(n){if(n.op==="=="){if(Kl(n.value))return{unaryFilter:{field:Je(n.field),op:"IS_NAN"}};if($l(n.value))return{unaryFilter:{field:Je(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Kl(n.value))return{unaryFilter:{field:Je(n.field),op:"IS_NOT_NAN"}};if($l(n.value))return{unaryFilter:{field:Je(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Je(n.field),op:Xf(n.op),value:n.value}}}(e):e instanceof Kt?function(n){let r=n.getFilters().map(i=>$h(i));return r.length===1?r[0]:{compositeFilter:{op:Jf(n.op),filters:r}}}(e):T()}function Zf(e){let t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function Kh(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}var or=class e{constructor(t,n,r,i,s=A.min(),o=A.min(),a=ht.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}};var jo=class{constructor(t){this.ct=t}};function tg(e){let t=Wf({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Ro(t,t.limit,"L"):t}var xi=class{constructor(){}Pt(t,n){this.It(t,n),n.Tt()}It(t,n){if("nullValue"in t)this.Et(n,5);else if("booleanValue"in t)this.Et(n,10),n.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(n,15),n.dt(B(t.integerValue));else if("doubleValue"in t){let r=B(t.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),er(r)?n.dt(0):n.dt(r))}else if("timestampValue"in t){let r=t.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,n),this.Vt(n);else if("bytesValue"in t)this.Et(n,30),n.ft(le(t.bytesValue)),this.Vt(n);else if("referenceValue"in t)this.gt(t.referenceValue,n);else if("geoPointValue"in t){let r=t.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in t?vh(t)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,n),this.Vt(n)):"arrayValue"in t?(this.wt(t.arrayValue,n),this.Vt(n)):T()}Rt(t,n){this.Et(n,25),this.St(t,n)}St(t,n){n.At(t)}yt(t,n){let r=t.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(t,n){let r=t.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(t,n){this.Et(n,37),I.fromName(t).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(t,n){t.dt(n)}Vt(t){t.dt(2)}};xi.bt=new xi;var $o=class{constructor(){this._n=new Ko}addToCollectionParentIndex(t,n){return this._n.add(n),f.resolve()}getCollectionParents(t,n){return f.resolve(this._n.getEntries(n))}addFieldIndex(t,n){return f.resolve()}deleteFieldIndex(t,n){return f.resolve()}deleteAllFieldIndexes(t){return f.resolve()}createTargetIndexes(t,n){return f.resolve()}getDocumentsMatchingTarget(t,n){return f.resolve(null)}getIndexType(t,n){return f.resolve(0)}getFieldIndexes(t,n){return f.resolve([])}getNextCollectionGroupToUpdate(t){return f.resolve(null)}getMinOffset(t,n){return f.resolve(De.min())}getMinOffsetFromCollectionGroup(t,n){return f.resolve(De.min())}updateCollectionGroup(t,n,r){return f.resolve()}updateIndexEntries(t,n){return f.resolve()}},Ko=class{constructor(){this.index={}}add(t){let n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new ut(U.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(t){let n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(t){return(this.index[t]||new ut(U.comparator)).toArray()}};var P_=new Uint8Array(0);var Lt=class e{constructor(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Lt.DEFAULT_COLLECTION_PERCENTILE=10,Lt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Lt.DEFAULT=new Lt(41943040,Lt.DEFAULT_COLLECTION_PERCENTILE,Lt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Lt.DISABLED=new Lt(-1,0,0);var ar=class e{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new e(0)}static Bn(){return new e(-1)}};var Qo=class{constructor(){this.changes=new he(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Pt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?f.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}};var Wo=class{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}};var Ho=class{constructor(t,n,r,i){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,n))).next(i=>(r!==null&&tr(r.mutation,i,qt.empty(),Q.now()),i))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,P()).next(()=>r))}getLocalViewOfDocuments(t,n,r=P()){let i=Ce();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,r).next(s=>{let o=Yn();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){let r=Ce();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,P()))}populateOverlays(t,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,r,i){let s=Jt(),o=Zn(),a=function(){return Zn()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof Zt)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),tr(l.mutation,u,l.mutation.getFieldMask(),Q.now())):o.set(u.key,qt.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var h;return a.set(u,new Wo(l,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(t,n){let r=Zn(),i=new z((o,a)=>o-a),s=P();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||qt.empty();l=a.applyToLocalView(u,l),r.set(c,l);let h=(i.get(a.batchId)||P()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,h=Rh();l.forEach(d=>{if(!s.has(d)){let g=Fh(n.get(d),r.get(d));g!==null&&h.set(d,g),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(t,u,h))}return f.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,i){return function(o){return I.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):wf(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,i):this.getDocumentsMatchingCollectionQuery(t,n,r,i)}getNextDocuments(t,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,i-s.size):f.resolve(Ce()),a=-1,c=s;return o.next(u=>f.forEach(u,(l,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(l)?f.resolve():this.remoteDocumentCache.getEntry(t,l).next(d=>{c=c.insert(l,d)}))).next(()=>this.populateOverlays(t,u,s)).next(()=>this.computeViews(t,c,u,P())).next(l=>({batchId:a,changes:Ph(l)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new I(n)).next(r=>{let i=Yn();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,n,r,i){let s=n.collectionGroup,o=Yn();return this.indexManager.getCollectionParents(t,s).next(a=>f.forEach(a,c=>{let u=function(h,d){return new ln(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,u,r,i).next(l=>{l.forEach((h,d)=>{o=o.insert(h,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,Pt.newInvalidDocument(l)))});let a=Yn();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&tr(l.mutation,u,qt.empty(),Q.now()),Wi(n,u)&&(a=a.insert(c,u))}),a})}};var Yo=class{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,n){return f.resolve(this.cr.get(n))}saveBundleMetadata(t,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Gt(i.createTime)}}(n)),f.resolve()}getNamedQuery(t,n){return f.resolve(this.lr.get(n))}saveNamedQuery(t,n){return this.lr.set(n.name,function(i){return{name:i.name,query:tg(i.bundledQuery),readTime:Gt(i.readTime)}}(n)),f.resolve()}};var Xo=class{constructor(){this.overlays=new z(I.comparator),this.hr=new Map}getOverlay(t,n){return f.resolve(this.overlays.get(n))}getOverlays(t,n){let r=Ce();return f.forEach(n,i=>this.getOverlay(t,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((i,s)=>{this.ht(t,n,s)}),f.resolve()}removeOverlaysForBatchId(t,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),f.resolve()}getOverlaysForCollection(t,n,r){let i=Ce(),s=n.length+1,o=new I(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return f.resolve(i)}getOverlaysForCollectionGroup(t,n,r,i){let s=new z((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=Ce(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=Ce(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return f.resolve(a)}ht(t,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new No(n,r));let s=this.hr.get(n);s===void 0&&(s=P(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var cr=class{constructor(){this.Pr=new ut(K.Ir),this.Tr=new ut(K.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,n){let r=new K(t,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Ar(new K(t,n))}Rr(t,n){t.forEach(r=>this.removeReference(r,n))}Vr(t){let n=new I(new U([])),r=new K(n,t),i=new K(n,t+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(t=>this.Ar(t))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){let n=new I(new U([])),r=new K(n,t),i=new K(n,t+1),s=P();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(t){let n=new K(t,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}},K=class{constructor(t,n){this.key=t,this.pr=n}static Ir(t,n){return I.comparator(t.key,n.key)||V(t.pr,n.pr)}static Er(t,n){return V(t.pr,n.pr)||I.comparator(t.key,n.key)}};var Jo=class{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new ut(K.Ir)}checkEmpty(t){return f.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new ko(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new K(a.key,s)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return f.resolve(o)}lookupMutationBatch(t,n){return f.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(t,n){let r=n+1,i=this.br(r),s=i<0?0:i;return f.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return f.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(t){return f.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){let r=new K(n,0),i=new K(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),f.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new ut(V);return n.forEach(i=>{let s=new K(i,0),o=new K(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),f.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(t,n){let r=n.path,i=r.length+1,s=r;I.isDocumentKey(s)||(s=s.child(""));let o=new K(new I(s),0),a=new ut(V);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),f.resolve(this.Dr(a))}Dr(t){let n=[];return t.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(t,n){O(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return f.forEach(n.mutations,i=>{let s=new K(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.wr=r})}Mn(t){}containsKey(t,n){let r=new K(n,0),i=this.wr.firstAfterOrEqual(r);return f.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,f.resolve()}Cr(t,n){return this.br(t)}br(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Sr(t){let n=this.br(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var Zo=class{constructor(t){this.vr=t,this.docs=function(){return new z(I.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){let n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){let r=this.docs.get(n);return f.resolve(r?r.document.mutableCopy():Pt.newInvalidDocument(n))}getEntries(t,n){let r=Jt();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Pt.newInvalidDocument(i))}),f.resolve(r)}getDocumentsMatchingQuery(t,n,r,i){let s=Jt(),o=n.path,a=new I(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||lf(uf(l),r)<=0||(i.has(l.key)||Wi(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return f.resolve(s)}getAllFromCollectionGroup(t,n,r,i){T()}Fr(t,n){return f.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new ta(this)}getSize(t){return f.resolve(this.size)}},ta=class extends Qo{constructor(t){super(),this.ar=t}applyChanges(t){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(t,i)):this.ar.removeEntry(r)}),f.waitFor(n)}getFromCache(t,n){return this.ar.getEntry(t,n)}getAllFromCache(t,n){return this.ar.getEntries(t,n)}};var ea=class{constructor(t){this.persistence=t,this.Mr=new he(n=>Ga(n),ja),this.lastRemoteSnapshotVersion=A.min(),this.highestTargetId=0,this.Or=0,this.Nr=new cr,this.targetCount=0,this.Br=ar.Nn()}forEachTarget(t,n){return this.Mr.forEach((r,i)=>n(i)),f.resolve()}getLastRemoteSnapshotVersion(t){return f.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return f.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),f.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),f.resolve()}qn(t){this.Mr.set(t.target,t);let n=t.targetId;n>this.highestTargetId&&(this.Br=new ar(n),this.highestTargetId=n),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,n){return this.qn(n),this.targetCount+=1,f.resolve()}updateTargetData(t,n){return this.qn(n),f.resolve()}removeTargetData(t,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,f.resolve()}removeTargets(t,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),f.waitFor(s).next(()=>i)}getTargetCount(t){return f.resolve(this.targetCount)}getTargetData(t,n){let r=this.Mr.get(n)||null;return f.resolve(r)}addMatchingKeys(t,n,r){return this.Nr.dr(n,r),f.resolve()}removeMatchingKeys(t,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),f.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.Nr.Vr(n),f.resolve()}getMatchingKeysForTargetId(t,n){let r=this.Nr.gr(n);return f.resolve(r)}containsKey(t,n){return f.resolve(this.Nr.containsKey(n))}};var na=class{constructor(t,n){this.Lr={},this.overlays={},this.kr=new _h(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new ea(this),this.indexManager=new $o,this.remoteDocumentCache=function(i){return new Zo(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new jo(n),this.$r=new Yo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new Xo,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.Lr[t.toKey()];return r||(r=new Jo(n,this.referenceDelegate),this.Lr[t.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,n,r){_("MemoryPersistence","Starting transaction:",t);let i=new ra(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(t,n){return f.or(Object.values(this.Lr).map(r=>()=>r.containsKey(t,n)))}},ra=class extends mo{constructor(t){super(),this.currentSequenceNumber=t}},ia=class e{constructor(t){this.persistence=t,this.zr=new cr,this.jr=null}static Hr(t){return new e(t)}get Jr(){if(this.jr)return this.jr;throw T()}addReference(t,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),f.resolve()}removeReference(t,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),f.resolve()}markPotentiallyOrphaned(t,n){return this.Jr.add(n.toString()),f.resolve()}removeTarget(t,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(t,n))}Ur(){this.jr=new Set}Wr(t){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return f.forEach(this.Jr,r=>{let i=I.fromPath(r);return this.Yr(t,i).next(s=>{s||n.removeEntry(i,A.min())})}).next(()=>(this.jr=null,n.apply(t)))}updateLimboDocument(t,n){return this.Yr(t,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(t){return 0}Yr(t,n){return f.or([()=>f.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Gr(t,n)])}};var sa=class e{constructor(t,n,r,i){this.targetId=t,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(t,n){let r=P(),i=P();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new e(t,n.fromCache,r,i)}};var oa=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}};var aa=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return zc()?8:yi.v(bn())>0?6:4}()}initialize(t,n){this.zi=t,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(t,n,r,i){let s={result:null};return this.ji(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(t,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new oa;return this.Ji(t,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(t,n,o,a.size)})}).next(()=>s.result)}Yi(t,n,r,i){return r.documentReadCount<this.Wi?(Hn()<=Wt.DEBUG&&_("QueryEngine","SDK will not create cache indexes for query:",Xe(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),f.resolve()):(Hn()<=Wt.DEBUG&&_("QueryEngine","Query:",Xe(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Hn()<=Wt.DEBUG&&_("QueryEngine","The SDK decides to create cache indexes for query:",Xe(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,zt(n))):f.resolve())}ji(t,n){if(Yl(n))return f.resolve(null);let r=zt(n);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Ro(n,null,"F"),r=zt(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(s=>{let o=P(...s);return this.zi.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,r).next(c=>{let u=this.Zi(n,a);return this.Xi(n,u,o,c.readTime)?this.ji(t,Ro(n,null,"F")):this.es(t,u,n,c)}))})))}Hi(t,n,r,i){return Yl(n)||i.isEqual(A.min())?f.resolve(null):this.zi.getDocuments(t,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?f.resolve(null):(Hn()<=Wt.DEBUG&&_("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Xe(n)),this.es(t,o,n,cf(i,-1)).next(a=>a))})}Zi(t,n){let r=new ut(Sh(t));return n.forEach((i,s)=>{Wi(t,s)&&(r=r.add(s))}),r}Xi(t,n,r,i){if(t.limit===null)return!1;if(r.size!==n.size)return!0;let s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(t,n,r){return Hn()<=Wt.DEBUG&&_("QueryEngine","Using full collection scan to execute query:",Xe(n)),this.zi.getDocumentsMatchingQuery(t,n,De.min(),r)}es(t,n,r,i){return this.zi.getDocumentsMatchingQuery(t,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var ca=class{constructor(t,n,r,i){this.persistence=t,this.ts=n,this.serializer=i,this.ns=new z(V),this.rs=new he(s=>Ga(s),ja),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(r)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Ho(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.ns))}};function eg(e,t,n,r){return new ca(e,t,n,r)}function Qh(e,t){return y(this,null,function*(){let n=C(e);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(t),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=P();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function ng(e,t){let n=C(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=t.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){let h=u.batch,d=h.keys(),g=f.resolve();return d.forEach(S=>{g=g.next(()=>l.getEntry(c,S)).next(b=>{let w=u.docVersions.get(S);O(w!==null),b.version.compareTo(w)<0&&(h.applyToRemoteDocument(b,u),b.isValidDocument()&&(b.setReadTime(u.commitVersion),l.addEntry(b)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(n,r,t,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=P();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(t))).next(()=>n.localDocuments.getDocuments(r,i))})}function Wh(e){let t=C(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Qr.getLastRemoteSnapshotVersion(n))}function rg(e,t){let n=C(e),r=t.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];t.targetChanges.forEach((l,h)=>{let d=i.get(h);if(!d)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,h).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,h)));let g=d.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(h)!==null?g=g.withResumeToken(ht.EMPTY_BYTE_STRING,A.min()).withLastLimboFreeSnapshotVersion(A.min()):l.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(l.resumeToken,r)),i=i.insert(h,g),function(b,w,M){return b.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(d,g,l)&&a.push(n.Qr.updateTargetData(s,g))});let c=Jt(),u=P();if(t.documentUpdates.forEach(l=>{t.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(ig(s,o,t.documentUpdates).next(l=>{c=l.cs,u=l.ls})),!r.isEqual(A.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(h=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return f.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ns=i,s))}function ig(e,t,n){let r=P(),i=P();return n.forEach(s=>r=r.add(s)),t.getEntries(e,r).next(s=>{let o=Jt();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(A.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):_("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function sg(e,t){let n=C(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function og(e,t){let n=C(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,t).next(s=>s?(i=s,f.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new or(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(t,r.targetId)),r})}function ua(e,t,n){return y(this,null,function*(){let r=C(e),i=r.ns.get(t),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!mr(o))throw o;_("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.ns=r.ns.remove(t),r.rs.delete(i.target)})}function ah(e,t,n){let r=C(e),i=A.min(),s=P();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){let h=C(c),d=h.rs.get(l);return d!==void 0?f.resolve(h.ns.get(d)):h.Qr.getTargetData(u,l)}(r,o,zt(t)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,t,n?i:A.min(),n?s:P())).next(a=>(ag(r,Tf(t),a),{documents:a,hs:s})))}function ag(e,t,n){let r=e.ss.get(t)||A.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),e.ss.set(t,r)}var Pi=class{constructor(){this.activeTargetIds=xf()}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){let t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}};var la=class{constructor(){this.no=new Pi,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,n,r){this.ro[t]=n}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new Pi,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}};var ha=class{io(t){}shutdown(){}};var Ri=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){_("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let t of this.uo)t(0)}ao(){_("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let t of this.uo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var di=null;function eo(){return di===null?di=function(){return 268435456+Math.round(2147483648*Math.random())}():di++,"0x"+di.toString(16)}var cg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var da=class{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}};var ct="WebChannelConnection",ma=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=eo(),c=this.bo(n,r.toUriEncodedString());_("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(u,s,o),this.Co(n,c,u,i).then(l=>(_("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw rn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+_n}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=cg[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,n,r,i){let s=eo();return new Promise((o,a)=>{let c=new ql;c.setWithCredentials(!0),c.listenOnce(Fl.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case li.NO_ERROR:let l=c.getResponseJson();_(ct,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(l)),o(l);break;case li.TIMEOUT:_(ct,`RPC '${t}' ${s} timed out`),a(new v(m.DEADLINE_EXCEEDED,"Request time out"));break;case li.HTTP_ERROR:let h=c.getStatus();if(_(ct,`RPC '${t}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);let g=d?.error;if(g&&g.status&&g.message){let S=function(w){let M=w.toLowerCase().replace(/_/g,"-");return Object.values(m).indexOf(M)>=0?M:m.UNKNOWN}(g.status);a(new v(S,g.message))}else a(new v(m.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new v(m.UNAVAILABLE,"Connection failed."));break;default:T()}}finally{_(ct,`RPC '${t}' ${s} completed.`)}});let u=JSON.stringify(i);_(ct,`RPC '${t}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Fo(t,n,r){let i=eo(),s=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Nl(),a=Ol(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");_(ct,`Creating RPC '${t}' stream ${i}: ${l}`,c);let h=o.createWebChannel(l,c),d=!1,g=!1,S=new da({lo:w=>{g?_(ct,`Not sending because RPC '${t}' stream ${i} is closed:`,w):(d||(_(ct,`Opening RPC '${t}' stream ${i} transport.`),h.open(),d=!0),_(ct,`RPC '${t}' stream ${i} sending:`,w),h.send(w))},ho:()=>h.close()}),b=(w,M,G)=>{w.listen(M,nt=>{try{G(nt)}catch(_t){setTimeout(()=>{throw _t},0)}})};return b(h,Wn.EventType.OPEN,()=>{g||_(ct,`RPC '${t}' stream ${i} transport opened.`)}),b(h,Wn.EventType.CLOSE,()=>{g||(g=!0,_(ct,`RPC '${t}' stream ${i} transport closed`),S.Vo())}),b(h,Wn.EventType.ERROR,w=>{g||(g=!0,rn(ct,`RPC '${t}' stream ${i} transport errored:`,w),S.Vo(new v(m.UNAVAILABLE,"The operation could not be completed")))}),b(h,Wn.EventType.MESSAGE,w=>{var M;if(!g){let G=w.data[0];O(!!G);let nt=G,_t=nt.error||((M=nt[0])===null||M===void 0?void 0:M.error);if(_t){_(ct,`RPC '${t}' stream ${i} received error:`,_t);let fe=_t.status,dt=function(Qd){let ac=$[Qd];if(ac!==void 0)return qh(ac)}(fe),Le=_t.message;dt===void 0&&(dt=m.INTERNAL,Le="Unknown error status: "+fe+" with message "+_t.message),g=!0,S.Vo(new v(dt,Le)),h.close()}else _(ct,`RPC '${t}' stream ${i} received:`,G),S.mo(G)}}),b(a,Ll.STAT_EVENT,w=>{w.stat===Zs.PROXY?_(ct,`RPC '${t}' stream ${i} detected buffering proxy`):w.stat===Zs.NOPROXY&&_(ct,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.Ro()},0),S}};function no(){return typeof document<"u"?document:null}function Hi(e){return new qo(e,!0)}var Di=class{constructor(t,n,r=1e3,i=1.5,s=6e4){this.oi=t,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&_("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),t())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var Vi=class{constructor(t,n,r,i,s,o,a,c){this.oi=t,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Di(t,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return y(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(t){this.n_(),this.stream.send(t)}e_(){return y(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(t,n){return y(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,t!==4?this.jo.reset():n&&n.code===m.RESOURCE_EXHAUSTED?(jt(n.toString()),jt("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===m.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let t=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{t(()=>{let i=new v(m.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(t,n){let r=this.s_(this.Wo);this.stream=this.a_(t,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>y(this,null,function*(){this.state=0,this.start()}))}__(t){return _("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return n=>{this.oi.enqueueAndForget(()=>this.Wo===t?n():(_("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},fa=class extends Vi{constructor(t,n,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(t,n){return this.connection.Fo("Listen",t,n)}onMessage(t){this.jo.reset();let n=Gf(this.serializer,t),r=function(s){if(!("targetChange"in s))return A.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?A.min():o.readTime?Gt(o.readTime):A.min()}(t);return this.listener.u_(n,r)}c_(t){let n={};n.database=Go(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=Po(c)?{documents:Kf(s,c)}:{query:Qf(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Bh(s,o.resumeToken);let u=Bo(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(A.min())>0){a.readTime=Si(s,o.snapshotVersion.toTimestamp());let u=Bo(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,t);let r=Hf(this.serializer,t);r&&(n.labels=r),this.t_(n)}l_(t){let n={};n.database=Go(this.serializer),n.removeTarget=t,this.t_(n)}},ga=class extends Vi{constructor(t,n,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,n){return this.connection.Fo("Write",t,n)}onMessage(t){if(O(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();let n=$f(t.writeResults,t.commitTime),r=Gt(t.commitTime);return this.listener.T_(r,n)}return O(!t.writeResults||t.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let t={};t.database=Go(this.serializer),this.t_(t)}I_(t){let n={streamToken:this.lastStreamToken,writes:t.map(r=>jf(this.serializer,r))};this.t_(n)}};var pa=class extends class{}{constructor(t,n,r,i){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new v(m.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(t,Uo(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===m.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new v(m.UNKNOWN,s.toString())})}vo(t,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(t,Uo(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===m.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new v(m.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var _a=class{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(t){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,t==="Online"&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){let n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(jt(n),this.g_=!1):_("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var ya=class{constructor(t,n,r,i,s){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>y(this,null,function*(){Oe(this)&&(_("RemoteStore","Restarting streams for network reachability change."),yield function(c){return y(this,null,function*(){let u=C(c);u.v_.add(4),yield fr(u),u.x_.set("Unknown"),u.v_.delete(4),yield Yi(u)})}(this))}))}),this.x_=new _a(r,i)}};function Yi(e){return y(this,null,function*(){if(Oe(e))for(let t of e.F_)yield t(!0)})}function fr(e){return y(this,null,function*(){for(let t of e.F_)yield t(!1)})}function Hh(e,t){let n=C(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),Ha(n)?Wa(n):vn(n).Jo()&&Qa(n,t))}function Yh(e,t){let n=C(e),r=vn(n);n.C_.delete(t),r.Jo()&&Xh(n,t),n.C_.size===0&&(r.Jo()?r.Xo():Oe(n)&&n.x_.set("Unknown"))}function Qa(e,t){if(e.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(A.min())>0){let n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}vn(e).c_(t)}function Xh(e,t){e.O_.Oe(t),vn(e).l_(t)}function Wa(e){e.O_=new Lo({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),vn(e).start(),e.x_.p_()}function Ha(e){return Oe(e)&&!vn(e).Ho()&&e.C_.size>0}function Oe(e){return C(e).v_.size===0}function Jh(e){e.O_=void 0}function ug(e){return y(this,null,function*(){e.C_.forEach((t,n)=>{Qa(e,t)})})}function lg(e,t){return y(this,null,function*(){Jh(e),Ha(e)?(e.x_.S_(t),Wa(e)):e.x_.set("Unknown")})}function hg(e,t,n){return y(this,null,function*(){if(e.x_.set("Online"),t instanceof Ai&&t.state===2&&t.cause)try{yield function(i,s){return y(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(e,t)}catch(r){_("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield ki(e,r)}else if(t instanceof en?e.O_.$e(t):t instanceof bi?e.O_.Je(t):e.O_.Ge(t),!n.isEqual(A.min()))try{let r=yield Wh(e.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let l=s.C_.get(u);l&&s.C_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let l=s.C_.get(c);if(!l)return;s.C_.set(c,l.withResumeToken(ht.EMPTY_BYTE_STRING,l.snapshotVersion)),Xh(s,c);let h=new or(l.target,c,u,l.sequenceNumber);Qa(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(e,n))}catch(r){_("RemoteStore","Failed to raise snapshot:",r),yield ki(e,r)}})}function ki(e,t,n){return y(this,null,function*(){if(!mr(t))throw t;e.v_.add(1),yield fr(e),e.x_.set("Offline"),n||(n=()=>Wh(e.localStore)),e.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){_("RemoteStore","Retrying IndexedDB access"),yield n(),e.v_.delete(1),yield Yi(e)}))})}function Zh(e,t){return t().catch(n=>ki(e,n,t))}function Xi(e){return y(this,null,function*(){let t=C(e),n=de(t),r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;dg(t);)try{let i=yield sg(t.localStore,r);if(i===null){t.D_.length===0&&n.Xo();break}r=i.batchId,mg(t,i)}catch(i){yield ki(t,i)}td(t)&&ed(t)})}function dg(e){return Oe(e)&&e.D_.length<10}function mg(e,t){e.D_.push(t);let n=de(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function td(e){return Oe(e)&&!de(e).Ho()&&e.D_.length>0}function ed(e){de(e).start()}function fg(e){return y(this,null,function*(){de(e).d_()})}function gg(e){return y(this,null,function*(){let t=de(e);for(let n of e.D_)t.I_(n.mutations)})}function pg(e,t,n){return y(this,null,function*(){let r=e.D_.shift(),i=Mo.from(r,t,n);yield Zh(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),yield Xi(e)})}function _g(e,t){return y(this,null,function*(){t&&de(e).P_&&(yield function(r,i){return y(this,null,function*(){if(function(o){return Nf(o)&&o!==m.ABORTED}(i.code)){let s=r.D_.shift();de(r).Zo(),yield Zh(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Xi(r)}})}(e,t)),td(e)&&ed(e)})}function ch(e,t){return y(this,null,function*(){let n=C(e);n.asyncQueue.verifyOperationInProgress(),_("RemoteStore","RemoteStore received new credentials");let r=Oe(n);n.v_.add(3),yield fr(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),yield Yi(n)})}function yg(e,t){return y(this,null,function*(){let n=C(e);t?(n.v_.delete(2),yield Yi(n)):t||(n.v_.add(2),yield fr(n),n.x_.set("Unknown"))})}function vn(e){return e.N_||(e.N_=function(n,r,i){let s=C(n);return s.R_(),new fa(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Po:ug.bind(null,e),To:lg.bind(null,e),u_:hg.bind(null,e)}),e.F_.push(t=>y(this,null,function*(){t?(e.N_.Zo(),Ha(e)?Wa(e):e.x_.set("Unknown")):(yield e.N_.stop(),Jh(e))}))),e.N_}function de(e){return e.B_||(e.B_=function(n,r,i){let s=C(n);return s.R_(),new ga(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Po:fg.bind(null,e),To:_g.bind(null,e),E_:gg.bind(null,e),T_:pg.bind(null,e)}),e.F_.push(t=>y(this,null,function*(){t?(e.B_.Zo(),yield Xi(e)):(yield e.B_.stop(),e.D_.length>0&&(_("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))}))),e.B_}var va=class e{constructor(t,n,r,i,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Bt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,s){let o=Date.now()+r,a=new e(t,n,o,i,s);return a.start(r),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new v(m.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ya(e,t){if(jt("AsyncQueue",`${t}: ${e}`),mr(e))return new v(m.UNAVAILABLE,`${t}: ${e}`);throw e}var Mi=class e{constructor(t){this.comparator=t?(n,r)=>t(n,r)||I.comparator(n.key,r.key):(n,r)=>I.comparator(n.key,r.key),this.keyedMap=Yn(),this.sortedSet=new z(this.comparator)}static emptySet(t){return new e(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){let n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){let n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){let n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){let r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}};var Ni=class{constructor(){this.L_=new z(I.comparator)}track(t){let n=t.doc.key,r=this.L_.get(n);r?t.type!==0&&r.type===3?this.L_=this.L_.insert(n,t):t.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.L_=this.L_.remove(n):t.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:t.doc}):T():this.L_=this.L_.insert(n,t)}k_(){let t=[];return this.L_.inorderTraversal((n,r)=>{t.push(r)}),t}},gn=class e{constructor(t,n,r,i,s,o,a,c,u){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(t,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new e(t,n,Mi.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Qi(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;let n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var wa=class{constructor(){this.q_=void 0,this.Q_=[]}},Ia=class{constructor(){this.queries=new he(t=>Ch(t),Qi),this.onlineState="Unknown",this.K_=new Set}};function vg(e,t){return y(this,null,function*(){let n=C(e),r=t.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new wa),i)try{s.q_=yield n.onListen(r)}catch(o){let a=Ya(o,`Initialization of query '${Xe(t.query)}' failed`);return void t.onError(a)}n.queries.set(r,s),s.Q_.push(t),t.U_(n.onlineState),s.q_&&t.W_(s.q_)&&Xa(n)})}function wg(e,t){return y(this,null,function*(){let n=C(e),r=t.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(t);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function Ig(e,t){let n=C(e),r=!1;for(let i of t){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&Xa(n)}function Tg(e,t,n){let r=C(e),i=r.queries.get(t);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(t)}function Xa(e){e.K_.forEach(t=>{t.next()})}var Ta=class{constructor(t,n,r){this.query=t,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(t){if(!this.options.includeMetadataChanges){let r=[];for(let i of t.docChanges)i.type!==3&&r.push(i);t=new gn(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.z_?this.H_(t)&&(this.G_.next(t),n=!0):this.J_(t,this.onlineState)&&(this.Y_(t),n=!0),this.j_=t,n}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),n=!0),n}J_(t,n){if(!t.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}H_(t){if(t.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(t){t=gn.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}};var Oi=class{constructor(t){this.key=t}},Fi=class{constructor(t){this.key=t}},Ea=class{constructor(t,n){this.query=t,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=P(),this.mutatedKeys=P(),this.ua=Sh(t),this.ca=new Mi(this.ua)}get la(){return this.oa}ha(t,n){let r=n?n.Pa:new Ni,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((l,h)=>{let d=i.get(l),g=Wi(this.query,h)?h:null,S=!!d&&this.mutatedKeys.has(d.key),b=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),w=!1;d&&g?d.data.isEqual(g.data)?S!==b&&(r.track({type:3,doc:g}),w=!0):this.Ia(d,g)||(r.track({type:2,doc:g}),w=!0,(c&&this.ua(g,c)>0||u&&this.ua(g,u)<0)&&(a=!0)):!d&&g?(r.track({type:0,doc:g}),w=!0):d&&!g&&(r.track({type:1,doc:d}),w=!0,(c||u)&&(a=!0)),w&&(g?(o=o.add(g),s=b?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,i){let s=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;let o=t.Pa.k_();o.sort((l,h)=>function(g,S){let b=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return T()}};return b(g)-b(S)}(l.type,h.type)||this.ua(l.doc,h.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],c=this.aa.size===0&&this.current&&!i?1:0,u=c!==this._a;return this._a=c,o.length!==0||u?{snapshot:new gn(this.query,t.ca,s,o,t.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new Ni,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=t.current)}Ea(){if(!this.current)return[];let t=this.aa;this.aa=P(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return t.forEach(r=>{this.aa.has(r)||n.push(new Fi(r))}),this.aa.forEach(r=>{t.has(r)||n.push(new Oi(r))}),n}Ra(t){this.oa=t.hs,this.aa=P();let n=this.ha(t.documents);return this.applyChanges(n,!0)}Va(){return gn.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},ba=class{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}},Aa=class{constructor(t){this.key=t,this.ma=!1}},Ca=class{constructor(t,n,r,i,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new he(a=>Ch(a),Qi),this.pa=new Map,this.ya=new Set,this.wa=new z(I.comparator),this.Sa=new Map,this.ba=new cr,this.Da={},this.Ca=new Map,this.va=ar.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function Eg(e,t){return y(this,null,function*(){let n=kg(e),r,i,s=n.ga.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield og(n.localStore,zt(t)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield bg(n,t,r,a==="current",o.resumeToken),n.isPrimaryClient&&Hh(n.remoteStore,o)}return i})}function bg(e,t,n,r,i){return y(this,null,function*(){e.Ma=(h,d,g)=>function(b,w,M,G){return y(this,null,function*(){let nt=w.view.ha(M);nt.Xi&&(nt=yield ah(b.localStore,w.query,!1).then(({documents:Le})=>w.view.ha(Le,nt)));let _t=G&&G.targetChanges.get(w.targetId),fe=G&&G.targetMismatches.get(w.targetId)!=null,dt=w.view.applyChanges(nt,b.isPrimaryClient,_t,fe);return lh(b,w.targetId,dt.da),dt.snapshot})}(e,h,d,g);let s=yield ah(e.localStore,t,!0),o=new Ea(t,s.hs),a=o.ha(s.documents),c=sr.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",i),u=o.applyChanges(a,e.isPrimaryClient,c);lh(e,n,u.da);let l=new ba(t,n,o);return e.ga.set(t,l),e.pa.has(n)?e.pa.get(n).push(t):e.pa.set(n,[t]),u.snapshot})}function Ag(e,t){return y(this,null,function*(){let n=C(e),r=n.ga.get(t),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!Qi(s,t))),void n.ga.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield ua(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Yh(n.remoteStore,r.targetId),Sa(n,r.targetId)}).catch(dr))):(Sa(n,r.targetId),yield ua(n.localStore,r.targetId,!0))})}function Cg(e,t,n){return y(this,null,function*(){let r=Mg(e);try{let i=yield function(o,a){let c=C(o),u=Q.now(),l=a.reduce((g,S)=>g.add(S.key),P()),h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let S=Jt(),b=P();return c.os.getEntries(g,l).next(w=>{S=w,S.forEach((M,G)=>{G.isValidDocument()||(b=b.add(M))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,S)).next(w=>{h=w;let M=[];for(let G of a){let nt=Mf(G,h.get(G.key).overlayedDocument);nt!=null&&M.push(new Zt(G.key,nt,wh(nt.value.mapValue),Xt.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,M,a)}).next(w=>{d=w;let M=w.applyToLocalDocumentSet(h,b);return c.documentOverlayCache.saveOverlays(g,w.batchId,M)})}).then(()=>({batchId:d.batchId,changes:Ph(h)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Da[o.currentUser.toKey()];u||(u=new z(V)),u=u.insert(a,c),o.Da[o.currentUser.toKey()]=u}(r,i.batchId,n),yield gr(r,i.changes),yield Xi(r.remoteStore)}catch(i){let s=Ya(i,"Failed to persist write");n.reject(s)}})}function nd(e,t){return y(this,null,function*(){let n=C(e);try{let r=yield rg(n.localStore,t);t.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&(O(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?O(o.ma):i.removedDocuments.size>0&&(O(o.ma),o.ma=!1))}),yield gr(n,r,t)}catch(r){yield dr(r)}})}function uh(e,t,n){let r=C(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(t);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=C(o);c.onlineState=a;let u=!1;c.queries.forEach((l,h)=>{for(let d of h.Q_)d.U_(a)&&(u=!0)}),u&&Xa(c)}(r.eventManager,t),i.length&&r.fa.u_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Sg(e,t,n){return y(this,null,function*(){let r=C(e);r.sharedClientState.updateQueryState(t,"rejected",n);let i=r.Sa.get(t),s=i&&i.key;if(s){let o=new z(I.comparator);o=o.insert(s,Pt.newNoDocument(s,A.min()));let a=P().add(s),c=new Ei(A.min(),new Map,new z(V),o,a);yield nd(r,c),r.wa=r.wa.remove(s),r.Sa.delete(t),Ja(r)}else yield ua(r.localStore,t,!1).then(()=>Sa(r,t,n)).catch(dr)})}function xg(e,t){return y(this,null,function*(){let n=C(e),r=t.batch.batchId;try{let i=yield ng(n.localStore,t);id(n,r,null),rd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield gr(n,i)}catch(i){yield dr(i)}})}function Pg(e,t,n){return y(this,null,function*(){let r=C(e);try{let i=yield function(o,a){let c=C(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(h=>(O(h!==null),l=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,t);id(r,t,n),rd(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),yield gr(r,i)}catch(i){yield dr(i)}})}function rd(e,t){(e.Ca.get(t)||[]).forEach(n=>{n.resolve()}),e.Ca.delete(t)}function id(e,t,n){let r=C(e),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(t);s&&(n?s.reject(n):s.resolve(),i=i.remove(t)),r.Da[r.currentUser.toKey()]=i}}function Sa(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(let r of e.pa.get(t))e.ga.delete(r),n&&e.fa.xa(r,n);e.pa.delete(t),e.isPrimaryClient&&e.ba.Vr(t).forEach(r=>{e.ba.containsKey(r)||sd(e,r)})}function sd(e,t){e.ya.delete(t.path.canonicalString());let n=e.wa.get(t);n!==null&&(Yh(e.remoteStore,n),e.wa=e.wa.remove(t),e.Sa.delete(n),Ja(e))}function lh(e,t,n){for(let r of n)r instanceof Oi?(e.ba.addReference(r.key,t),Rg(e,r)):r instanceof Fi?(_("SyncEngine","Document no longer in limbo: "+r.key),e.ba.removeReference(r.key,t),e.ba.containsKey(r.key)||sd(e,r.key)):T()}function Rg(e,t){let n=t.key,r=n.path.canonicalString();e.wa.get(n)||e.ya.has(r)||(_("SyncEngine","New document in limbo: "+n),e.ya.add(r),Ja(e))}function Ja(e){for(;e.ya.size>0&&e.wa.size<e.maxConcurrentLimboResolutions;){let t=e.ya.values().next().value;e.ya.delete(t);let n=new I(U.fromString(t)),r=e.va.next();e.Sa.set(r,new Aa(n)),e.wa=e.wa.insert(n,r),Hh(e.remoteStore,new or(zt($a(n.path)),r,"TargetPurposeLimboResolution",_h._e))}}function gr(e,t,n){return y(this,null,function*(){let r=C(e),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,c)=>{o.push(r.Ma(c,t,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=sa.Ki(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(c,u){return y(this,null,function*(){let l=C(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>f.forEach(u,d=>f.forEach(d.qi,g=>l.persistence.referenceDelegate.addReference(h,d.targetId,g)).next(()=>f.forEach(d.Qi,g=>l.persistence.referenceDelegate.removeReference(h,d.targetId,g)))))}catch(h){if(!mr(h))throw h;_("LocalStore","Failed to update sequence numbers: "+h)}for(let h of u){let d=h.targetId;if(!h.fromCache){let g=l.ns.get(d),S=g.snapshotVersion,b=g.withLastLimboFreeSnapshotVersion(S);l.ns=l.ns.insert(d,b)}}})}(r.localStore,s))})}function Dg(e,t){return y(this,null,function*(){let n=C(e);if(!n.currentUser.isEqual(t)){_("SyncEngine","User change. New user:",t.toKey());let r=yield Qh(n.localStore,t);n.currentUser=t,function(s,o){s.Ca.forEach(a=>{a.forEach(c=>{c.reject(new v(m.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield gr(n,r.us)}})}function Vg(e,t){let n=C(e),r=n.Sa.get(t);if(r&&r.ma)return P().add(r.key);{let i=P(),s=n.pa.get(t);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function kg(e){let t=C(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=nd.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Vg.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Sg.bind(null,t),t.fa.u_=Ig.bind(null,t.eventManager),t.fa.xa=Tg.bind(null,t.eventManager),t}function Mg(e){let t=C(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=xg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Pg.bind(null,t),t}var Li=class{constructor(){this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=Hi(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),yield this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)})}createGarbageCollectionScheduler(t,n){return null}createIndexBackfillerScheduler(t,n){return null}createLocalStore(t){return eg(this.persistence,new aa,t.initialUser,this.serializer)}createPersistence(t){return new na(ia.Hr,this.serializer)}createSharedClientState(t){return new la}terminate(){return y(this,null,function*(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var xa=class{initialize(t,n){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>uh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Dg.bind(null,this.syncEngine),yield yg(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Ia}()}createDatastore(t){let n=Hi(t.databaseInfo.databaseId),r=function(s){return new ma(s)}(t.databaseInfo);return function(s,o,a,c){return new pa(s,o,a,c)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,i,s,o,a){return new ya(r,i,s,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>uh(this.syncEngine,n,0),function(){return Ri.D()?new Ri:new ha}())}createSyncEngine(t,n){return function(i,s,o,a,c,u,l){let h=new Ca(i,s,o,a,c,u);return l&&(h.Fa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}terminate(){return y(this,null,function*(){var t;yield function(r){return y(this,null,function*(){let i=C(r);_("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield fr(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate()})}};var Pa=class{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):jt("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,n){this.muted||setTimeout(()=>{this.muted||t(n)},0)}};var Ra=class{constructor(t,n,r,i){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=et.UNAUTHENTICATED,this.clientId=pi.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>y(this,null,function*(){_("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(_("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new v(m.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let t=new Bt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){let r=Ya(n,"Failed to shutdown persistence");t.reject(r)}})),t.promise}};function ro(e,t){return y(this,null,function*(){e.asyncQueue.verifyOperationInProgress(),_("FirestoreClient","Initializing OfflineComponentProvider");let n=e.configuration;yield t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield Qh(t.localStore,i),r=i)})),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t})}function hh(e,t){return y(this,null,function*(){e.asyncQueue.verifyOperationInProgress();let n=yield Og(e);_("FirestoreClient","Initializing OnlineComponentProvider"),yield t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>ch(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,i)=>ch(t.remoteStore,i)),e._onlineComponents=t})}function Ng(e){return e.name==="FirebaseError"?e.code===m.FAILED_PRECONDITION||e.code===m.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}function Og(e){return y(this,null,function*(){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){_("FirestoreClient","Using user provided OfflineComponentProvider");try{yield ro(e,e._uninitializedComponentsProvider._offline)}catch(t){let n=t;if(!Ng(n))throw n;rn("Error using user provided cache. Falling back to memory cache: "+n),yield ro(e,new Li)}}else _("FirestoreClient","Using default OfflineComponentProvider"),yield ro(e,new Li);return e._offlineComponents})}function od(e){return y(this,null,function*(){return e._onlineComponents||(e._uninitializedComponentsProvider?(_("FirestoreClient","Using user provided OnlineComponentProvider"),yield hh(e,e._uninitializedComponentsProvider._online)):(_("FirestoreClient","Using default OnlineComponentProvider"),yield hh(e,new xa))),e._onlineComponents})}function Fg(e){return od(e).then(t=>t.syncEngine)}function dh(e){return y(this,null,function*(){let t=yield od(e),n=t.eventManager;return n.onListen=Eg.bind(null,t.syncEngine),n.onUnlisten=Ag.bind(null,t.syncEngine),n})}function ad(e){let t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}var mh=new Map;function cd(e,t,n){if(!n)throw new v(m.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Lg(e,t,n,r){if(t===!0&&r===!0)throw new v(m.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function fh(e){if(!I.isDocumentKey(e))throw new v(m.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function gh(e){if(I.isDocumentKey(e))throw new v(m.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Za(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{let t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":T()}function ae(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new v(m.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Za(e);throw new v(m.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}var qi=class{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new v(m.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new v(m.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}Lg("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ad((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new v(m.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new v(m.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new v(m.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}},pn=class{constructor(t,n,r,i){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qi({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new v(m.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new v(m.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qi(t),t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new io;switch(r.type){case"firstParty":return new co(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new v(m.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=mh.get(n);r&&(_("ComponentProvider","Removing Datastore"),mh.delete(n),r.terminate())}(this),Promise.resolve()}};function ud(e,t,n,r={}){var i;let s=(e=ae(e,pn))._getSettings(),o=`${t}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&rn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=et.MOCK_USER;else{a=Uc(r.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new v(m.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new et(u)}e._authCredentials=new so(new gi(a,c))}}var Bi=class e{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new e(this.firestore,t,this._query)}},It=class e{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ce(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new e(this.firestore,t,this._key)}},ce=class e extends Bi{constructor(t,n,r){super(t,n,$a(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let t=this._path.popLast();return t.isEmpty()?null:new It(this.firestore,null,new I(t))}withConverter(t){return new e(this.firestore,t,this._path)}};function Ji(e,t,...n){if(e=ye(e),cd("collection","path",t),e instanceof pn){let r=U.fromString(t,...n);return gh(r),new ce(e,null,r)}{if(!(e instanceof It||e instanceof ce))throw new v(m.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=e._path.child(U.fromString(t,...n));return gh(r),new ce(e.firestore,null,r)}}function tc(e,t,...n){if(e=ye(e),arguments.length===1&&(t=pi.newId()),cd("doc","path",t),e instanceof pn){let r=U.fromString(t,...n);return fh(r),new It(e,null,new I(r))}{if(!(e instanceof It||e instanceof ce))throw new v(m.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=e._path.child(U.fromString(t,...n));return fh(r),new It(e.firestore,e instanceof ce?e.converter:null,new I(r))}}var Da=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Di(this,"async_queue_retry"),this._u=()=>{let n=no();n&&_("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let t=no();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;let n=no();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise(()=>{});let n=new Bt;return this.uu(()=>this.tu&&this.su?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.eu.push(t),this.cu()))}cu(){return y(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!mr(t))throw t;_("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(t){let n=this.Xa.then(()=>(this.iu=!0,t().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw jt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(t,n,r){this.au(),this.ou.indexOf(t)>-1&&(n=0);let i=va.createAndSchedule(this,t,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&T()}verifyOperationInProgress(){}hu(){return y(this,null,function*(){let t;do t=this.Xa,yield t;while(t!==this.Xa)})}Pu(t){for(let n of this.nu)if(n.timerId===t)return!0;return!1}Iu(t){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.hu()})}Tu(t){this.ou.push(t)}lu(t){let n=this.nu.indexOf(t);this.nu.splice(n,1)}};function ph(e){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(e,["next","error","complete"])}var me=class extends pn{constructor(t,n,r,i){super(t,n,r,i),this.type="firestore",this._queue=function(){return new Da}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||dd(this),this._firestoreClient.terminate()}};function ld(e,t){let n=typeof e=="object"?e:Yc(),r=typeof e=="string"?e:t||"(default)",i=Wc(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Bc("firestore");s&&ud(i,...s)}return i}function hd(e){return e._firestoreClient||dd(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function dd(e){var t,n,r;let i=e._freezeSettings(),s=function(a,c,u,l){return new _o(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,ad(l.experimentalLongPollingOptions),l.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Ra(e._authCredentials,e._appCheckCredentials,e._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var ur=class e{constructor(t){this._byteString=t}static fromBase64String(t){try{return new e(ht.fromBase64String(t))}catch(n){throw new v(m.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new e(ht.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}};var lr=class{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new v(m.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}};var Ui=class{constructor(t){this._methodName=t}};var hr=class{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new v(m.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new v(m.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return V(this._lat,t._lat)||V(this._long,t._long)}};var qg=/^__.*__$/,Va=class{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Zt(t,this.data,this.fieldMask,n,this.fieldTransforms):new Ne(t,this.data,n,this.fieldTransforms)}};function md(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw T()}}var ka=class e{constructor(t,n,r,i,s,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Au({path:r,Vu:!1});return i.mu(t),i}fu(t){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return zi(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(t.length===0)throw this.pu("Document fields must not be empty");if(md(this.du)&&qg.test(t))throw this.pu('Document fields cannot begin and end with "__"')}},Ma=class{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Hi(t)}Su(t,n,r,i=!1){return new ka({du:t,methodName:n,wu:r,path:wt.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function fd(e){let t=e._freezeSettings(),n=Hi(e._databaseId);return new Ma(e._databaseId,!!t.ignoreUndefinedProperties,n)}function gd(e,t,n,r,i,s={}){let o=e.Su(s.merge||s.mergeFields?2:0,t,n,i);vd("Data must be an object, but it was:",o,r);let a=_d(r,o),c,u;if(s.merge)c=new qt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let h of s.mergeFields){let d=Bg(t,h,n);if(!o.contains(d))throw new v(m.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);zg(l,d)||l.push(d)}c=new qt(l),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new Va(new xt(a),c,u)}function pd(e,t){if(yd(e=ye(e)))return vd("Unsupported field value:",t,e),_d(e,t);if(e instanceof Ui)return function(r,i){if(!md(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Vu&&t.du!==4)throw t.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=pd(a,i.gu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(e,t)}return function(r,i){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Pf(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Q.fromDate(r);return{timestampValue:Si(i.serializer,s)}}if(r instanceof Q){let s=new Q(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Si(i.serializer,s)}}if(r instanceof hr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ur)return{bytesValue:Bh(i.serializer,r._byteString)};if(r instanceof It){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ka(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${Za(r)}`)}(e,t)}function _d(e,t){let n={};return yh(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):yn(e,(r,i)=>{let s=pd(i,t.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function yd(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Q||e instanceof hr||e instanceof ur||e instanceof It||e instanceof Ui)}function vd(e,t,n){if(!yd(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Za(n);throw r==="an object"?t.pu(e+" a custom object"):t.pu(e+" "+r)}}function Bg(e,t,n){if((t=ye(t))instanceof lr)return t._internalPath;if(typeof t=="string")return wd(e,t);throw zi("Field path arguments must be of type string or ",e,!1,void 0,n)}var Ug=new RegExp("[~\\*/\\[\\]]");function wd(e,t,n){if(t.search(Ug)>=0)throw zi(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new lr(...t.split("."))._internalPath}catch{throw zi(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function zi(e,t,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new v(m.INVALID_ARGUMENT,a+e+c)}function zg(e,t){return e.some(n=>n.isEqual(t))}var Gi=class{constructor(t,n,r,i,s){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let t=new Na(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){let n=this._document.data.field(Id("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}},Na=class extends Gi{data(){return super.data()}};function Id(e,t){return typeof t=="string"?wd(e,t):t instanceof lr?t._internalPath:t._delegate._internalPath}function Gg(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new v(m.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Oa=class{convertValue(t,n="none"){switch(Ve(t)){case 0:return null;case 1:return t.booleanValue;case 2:return B(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(le(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 10:return this.convertObject(t.mapValue,n);default:throw T()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){let r={};return yn(t,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(t){return new hr(B(t.latitude),B(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":let r=Ua(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(nr(t));default:return null}}convertTimestamp(t){let n=ue(t);return new Q(n.seconds,n.nanos)}convertDocumentKey(t,n){let r=U.fromString(t);O(Kh(r));let i=new Ii(r.get(1),r.get(3)),s=new I(r.popFirst(5));return i.isEqual(n)||jt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Td(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}var xe=class{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}},ji=class extends Gi{constructor(t,n,r,i,s,o){super(t,n,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){let n=new nn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){let r=this._document.data.field(Id("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},nn=class extends ji{data(t={}){return super.data(t)}},Fa=class{constructor(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new xe(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new nn(this._firestore,this._userDataWriter,r.key,r,new xe(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){let n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new v(m.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new nn(i._firestore,i._userDataWriter,a.doc.key,a.doc,new xe(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new nn(i._firestore,i._userDataWriter,a.doc.key,a.doc,new xe(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:jg(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function jg(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return T()}}var $i=class extends Oa{constructor(t){super(),this.firestore=t}convertBytes(t){return new ur(t)}convertReference(t){let n=this.convertDocumentKey(t,this.firestore._databaseId);return new It(this.firestore,null,n)}};function Ed(e,t,n){e=ae(e,It);let r=ae(e.firestore,me),i=Td(e.converter,t,n);return nc(r,[gd(fd(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,Xt.none())])}function bd(e){return nc(ae(e.firestore,me),[new ir(e._key,Xt.none())])}function Ad(e,t){let n=ae(e.firestore,me),r=tc(e),i=Td(e.converter,t);return nc(n,[gd(fd(e.firestore),"addDoc",r._key,i,e.converter!==null,{}).toMutation(r._key,Xt.exists(!1))]).then(()=>r)}function ec(e,...t){var n,r,i;e=ye(e);let s={includeMetadataChanges:!1},o=0;typeof t[o]!="object"||ph(t[o])||(s=t[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(ph(t[o])){let h=t[o];t[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),t[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),t[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,u,l;if(e instanceof It)u=ae(e.firestore,me),l=$a(e._key.path),c={next:h=>{t[o]&&t[o]($g(u,e,h))},error:t[o+1],complete:t[o+2]};else{let h=ae(e,Bi);u=ae(h.firestore,me),l=h._query;let d=new $i(u);c={next:g=>{t[o]&&t[o](new Fa(u,d,h,g))},error:t[o+1],complete:t[o+2]},Gg(e._query)}return function(d,g,S,b){let w=new Pa(b),M=new Ta(g,w,S);return d.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return vg(yield dh(d),M)})),()=>{w.La(),d.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return wg(yield dh(d),M)}))}}(hd(u),l,a,c)}function nc(e,t){return function(r,i){let s=new Bt;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Cg(yield Fg(r),i,s)})),s.promise}(hd(e),t)}function $g(e,t,n){let r=n.docs.get(t._key),i=new $i(e);return new ji(e,i,t._key,r,new xe(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(i){_n=i})(Hc),Qc(new $c("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new me(new oo(r.getProvider("auth-internal")),new lo(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new v(m.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ii(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),An(Ul,"4.4.3",t),An(Ul,"4.4.3","esm2017")})();var Zi=function(){return Zi=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Zi.apply(this,arguments)};var Wg={includeMetadataChanges:!1};function Cd(e,t){return t===void 0&&(t=Wg),new _r(function(n){var r=ec(e,t,{next:n.next.bind(n),error:n.error.bind(n),complete:n.complete.bind(n)});return{unsubscribe:r}})}function Sd(e,t){var n;t===void 0&&(t={});var r=e.data(t);return!e.exists()||typeof r!="object"||r===null||!t.idField?r:Zi(Zi({},r),(n={},n[t.idField]=e.id,n))}function xd(e){return Cd(e,{includeMetadataChanges:!0}).pipe(ns(function(t){return t.docs}))}function Pd(e,t){return t===void 0&&(t={}),xd(e).pipe(ns(function(n){return n.map(function(r){return Sd(r,t)})}))}var Fe=class{constructor(t){return t}},Rd="firestore",rc=class{constructor(){return Zc(Rd)}};var ic=new ge("angularfire2.firestore-instances");function Hg(e,t){let n=Jc(Rd,e,t);return n&&new Fe(n)}function Yg(e){return(t,n)=>{let r=t.runOutsideAngular(()=>e(n));return new Fe(r)}}var Xg={provide:rc,deps:[[new In,ic]]},Jg={provide:Fe,useFactory:Hg,deps:[[new In,ic],nu]},Zg=(()=>{class e{constructor(){An("angularfire",Xc.full,"fst")}static \u0275fac=function(r){return new(r||e)};static \u0275mod=Rt({type:e});static \u0275inj=Vt({providers:[Jg,Xg]})}return e})();function uv(e,...t){return{ngModule:Zg,providers:[{provide:ic,useFactory:Yg(e),multi:!0,deps:[vc,_c,eu,ru,[new In,iu],[new In,tu],...t]}]}}var sc=ve(Pd,!0);var Dd=ve(Ad,!0);var Vd=ve(bd,!0);var oc=ve(tc,!0);var lv=ve(ld,!0);var kd=ve(Ed,!0);var ts=(()=>{let t=class t{constructor(){this.firestore=W(Fe)}getUsers(){return sc(this.usersCollection,{idField:"id"})}getThoughts(){return sc(this.thoughtsCollection,{idField:"id"})}addThought(r){let i=Dd(this.thoughtsCollection,r).then(s=>s.id);return wn(i)}updateThought(r,i){let s=oc(this.firestore,"thoughts/"+r),o=kd(s,i);return wn(o)}removeThought(r){let i=oc(this.firestore,"thoughts/"+r),s=Vd(i);return wn(s)}get usersCollection(){return Ji(this.firestore,"users")}get thoughtsCollection(){return Ji(this.firestore,"thoughts")}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Dt({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var tp=["*"];var ep=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],np=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],rp=new ge("MAT_CARD_CONFIG"),Md=(()=>{let t=class t{constructor(r){this.appearance=r?.appearance||"raised"}};t.\u0275fac=function(i){return new(i||t)(H(rp,8))},t.\u0275cmp=X({type:t,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(i,s){i&2&&te("mat-mdc-card-outlined",s.appearance==="outlined")("mdc-card--outlined",s.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],standalone:!0,features:[J],ngContentSelectors:tp,decls:1,vars:0,template:function(i,s){i&1&&(pe(),Mt(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{color:rgba(0, 0, 0, 0.6);flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mdc-card__action--icon:not(:disabled){color:rgba(0, 0, 0, 0.6)}.mat-mdc-card{border-radius:var(--mdc-elevated-card-container-shape);background-color:var(--mdc-elevated-card-container-color);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color);box-shadow:var(--mdc-elevated-card-container-elevation)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape)}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width);border-style:solid;border-color:var(--mdc-outlined-card-outline-color);border-radius:var(--mdc-outlined-card-container-shape);background-color:var(--mdc-outlined-card-container-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.mat-mdc-card-outlined .mdc-card::after{border-radius:var(--mdc-outlined-card-container-shape)}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font);line-height:var(--mat-card-title-text-line-height);font-size:var(--mat-card-title-text-size);letter-spacing:var(--mat-card-title-text-tracking);font-weight:var(--mat-card-title-text-weight)}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color);font-family:var(--mat-card-subtitle-text-font);line-height:var(--mat-card-subtitle-text-line-height);font-size:var(--mat-card-subtitle-text-size);letter-spacing:var(--mat-card-subtitle-text-tracking);font-weight:var(--mat-card-subtitle-text-weight)}.mat-mdc-card{position:relative}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0});let e=t;return e})(),Nd=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=Qt({type:t,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"],standalone:!0});let e=t;return e})();var Od=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=Qt({type:t,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"],standalone:!0});let e=t;return e})(),Fd=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=Qt({type:t,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"],standalone:!0});let e=t;return e})();var Ld=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=X({type:t,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],standalone:!0,features:[J],ngContentSelectors:np,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(i,s){i&1&&(pe(ep),Mt(0),D(1,"div",0),Mt(2,1),N(),Mt(3,2))},encapsulation:2,changeDetection:0});let e=t;return e})();var qd=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=Qt({type:t,selectors:[["","mat-card-avatar",""],["","matCardAvatar",""]],hostAttrs:[1,"mat-mdc-card-avatar"],standalone:!0});let e=t;return e})();var Bd=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Rt({type:t}),t.\u0275inj=Vt({imports:[Tt,pt,Tt]});let e=t;return e})();var Ud=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Rt({type:t}),t.\u0275inj=Vt({imports:[Tt,Tt]});let e=t;return e})();var zd=(()=>{let t=class t{transform(r){let{thought:i,uid:s}=r;return i.likedBy.indexOf(s,0)>-1?"check_circle":"radio_button_unchecked"}};t.\u0275fac=function(i){return new(i||t)},t.\u0275pipe=yr({name:"appCheckIcon",type:t,pure:!0,standalone:!0});let e=t;return e})();var Gd=(()=>{let t=class t{transform(r){if(!r)return null;let i=new Date(r*1e3),s=i.getDate().toString().padStart(2,"0"),o=(i.getMonth()+1).toString().padStart(2,"0"),a=i.getFullYear().toString();return`${s}/${o}/${a}`}};t.\u0275fac=function(i){return new(i||t)},t.\u0275pipe=yr({name:"appTimestamp",type:t,pure:!0,standalone:!0});let e=t;return e})();var op=(e,t)=>t.id;function ap(e,t){if(e&1){let n=En();D(0,"button",11),ft("click",function(){qe(n);let i=ee().$implicit,s=ee();return Be(s.removeThought(i.id))}),D(1,"mat-icon",12),gt(2,"delete"),N()()}}var cp=(e,t)=>({thought:e,uid:t});function up(e,t){if(e&1){let n=En();D(0,"div",0)(1,"mat-card",1)(2,"mat-card-content")(3,"textarea",2,3),ft("blur",function(){let s=qe(n).$implicit,o=Ic(4),a=ee();return Be(a.changeThoughtContent(s,o.value))}),N()(),yt(5,"span",4),D(6,"mat-card-header",5),yt(7,"div",6),D(8,"mat-card-title"),gt(9),N(),D(10,"mat-card-subtitle"),gt(11),Cr(12,"appTimestamp"),N(),yt(13,"span",4),D(14,"button",7),ft("click",function(){let s=qe(n).$implicit,o=ee();return Be(o.changeThoughtLikes(s))}),D(15,"mat-icon",8),gt(16),Cr(17,"appCheckIcon"),N(),D(18,"span",9),gt(19),N()(),vr(20,ap,3,0,"button",10),N()()()}if(e&2){let n=t.$implicit,r=ee();j(3),mt("value",n==null?null:n.textContent),j(6),Ar(n==null?null:n.username),j(2),Tc(" ",Sr(12,9,n==null||n.timestamp==null?null:n.timestamp.seconds)," "),j(3),mt("disabled",!r.isAuthenticated),j(),mt("ngClass",r.isAuthenticated?"enabled":"disabled"),j(),Ar(Sr(17,11,Sc(13,cp,n,r.uid))),j(2),mt("ngClass",r.isAuthenticated?"enabled":"disabled"),j(),Ar(n.like),j(),Ir(20,r.isAuthenticated&&n.userUid===r.uid&&n.username===r.username?20:-1)}}function lp(e,t){e&1&&(D(0,"span"),gt(1,"There are no items."),N())}var jd=(()=>{var t,n,r;let i=class i{constructor(){L(this,t,void 0);L(this,n,void 0);L(this,r,void 0);bt(this,t,W(ts)),bt(this,n,W(je)),bt(this,r,W(ie)),this.thoughts$=new _r}ngOnInit(){this.thoughts$=x(this,t).getThoughts(),this.thoughts$=lc([x(this,n).userInput$,this.thoughts$]).pipe(dc(([o,a])=>uc(a.filter(c=>c.textContent.includes(o??"")))))}changeThoughtContent(o,a){a.trim()!=o.textContent.trim()&&x(this,t).updateThought(o.id,cc(es({},o),{textContent:a}))}changeThoughtLikes(o){let a=o.likedBy.indexOf(this.uid,0);a>-1?(o.likedBy.splice(a,1),o.like=o.like-1):(o.likedBy.push(this.uid),o.like=o.like+1),x(this,t).updateThought(o.id,es({},o))}removeThought(o){x(this,t).removeThought(o)}get isAuthenticated(){return x(this,r).isAuthenticated}get uid(){return x(this,r).uid}get username(){return x(this,r).username}};t=new WeakMap,n=new WeakMap,r=new WeakMap,i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=X({type:i,selectors:[["app-thoughts-list"]],standalone:!0,features:[J],decls:4,vars:3,consts:[[1,"card-container"],[1,"card"],["type","text",3,"value","blur"],["txtArea",""],[1,"spacer"],[1,"header"],["mat-card-avatar","",1,"header-image"],["mat-button","",1,"like-btn",3,"disabled","click"],["color","primary",3,"ngClass"],[3,"ngClass"],["mat-button",""],["mat-button","",3,"click"],["color","accent"],["class","card-container"]],template:function(a,c){a&1&&(Tr(0,up,21,16,"div",13,op,!1,lp,2,0,"span"),Cr(3,"async")),a&2&&Er(Sr(3,1,c.thoughts$))},dependencies:[pt,Pc,Rc,Bd,Md,qd,Od,Ld,Fd,Nd,re,Pr,Ud,ne,xr,Dr,zd,Gd],styles:["[_nghost-%COMP%]{display:inline-grid;grid-template-columns:auto;gap:3vmin;padding:6vmin}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]{border:1px solid #a112d53d;border-radius:4px}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]:hover{border:1px solid #333}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{z-index:0}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:none;border:none;outline:none;width:100%;height:10vh;color:#333;letter-spacing:.025rem;line-height:18px}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{border-top:1px solid #e2e2e2;background-color:#f7f7f7;border-bottom-left-radius:4px;border-bottom-right-radius:4px}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .header-image[_ngcontent-%COMP%]{background-image:url(https://material.angular.io/assets/img/examples/shiba1.jpg);background-size:cover}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]   mat-icon.enabled[_ngcontent-%COMP%]{color:#22ffb5}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]   mat-icon.disabled[_ngcontent-%COMP%]{color:#cfcfcf}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#444}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]   span.enabled[_ngcontent-%COMP%]{color:#444}[_nghost-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]   span.disabled[_ngcontent-%COMP%]{color:#cfcfcf}@media (min-width: 728px){[_nghost-%COMP%]{grid-template-columns:auto auto;padding:3vmin}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]{height:100%}}@media (min-width: 1080px){[_nghost-%COMP%]{grid-template-columns:auto auto auto;padding:3vmin}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]{height:100%}}@media (min-width: 1420px){[_nghost-%COMP%]{grid-template-columns:auto auto auto auto;padding:3vmin}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]{height:100%}}",".spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-toolbar[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-fab[_ngcontent-%COMP%]{background:linear-gradient(to right bottom,#eb054e,#db0a84,#a212d5)}.mat-mdc-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-unelevated-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-card-content[_ngcontent-%COMP%]{padding-bottom:16px}.mat-mdc-radio-button.mat-primary[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color: #fff;--mdc-radio-disabled-unselected-icon-color: #fff;--mdc-radio-unselected-hover-icon-color: #fff;--mdc-radio-unselected-icon-color: #fff;--mdc-radio-unselected-pressed-icon-color: #fff;--mdc-radio-selected-hover-icon-color: #fff;--mdc-radio-selected-focus-icon-color: #fff;--mdc-radio-selected-icon-color: #fff;--mdc-radio-selected-pressed-icon-color: #fff;--mat-radio-ripple-color: #fff;--mat-radio-checked-ripple-color: #fff;--mat-radio-disabled-label-color: #fff}"],changeDetection:0});let e=i;return e})();var $d=(()=>{let t=class t{fireBaseTimeStamp(){let r=new Date,i=Q.fromDate(r);return new Q(i.seconds,i.nanoseconds)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Dt({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Kd=(()=>{var t,n,r,i,s,o,a;let c=class c{constructor(){L(this,t,W($d));L(this,n,W(ie));L(this,r,W(ts));L(this,i,W(je));L(this,s,kt(!1));L(this,o,kt(!1));L(this,a,kt(!1));yc(()=>{x(this,s).update(l=>l=!!x(this,i).userInputSignal()?.length),x(this,o).update(l=>l=x(this,n).isAuthenticated),x(this,a).update(l=>l=this.isAuth()&&this.hasText())},{allowSignalWrites:!0})}addThought(){let l=x(this,t).fireBaseTimeStamp(),h=x(this,i).userInputValue,d=x(this,n).uid,g=x(this,n).username;x(this,r).addThought({textContent:h??"",username:g,timestamp:l,like:0,userUid:d,likedBy:[]})}get condition(){return x(this,a).asReadonly()}get isAuth(){return x(this,o).asReadonly()}get hasText(){return x(this,s).asReadonly()}};t=new WeakMap,n=new WeakMap,r=new WeakMap,i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,c.\u0275fac=function(h){return new(h||c)},c.\u0275cmp=X({type:c,selectors:[["app-create-thought"]],standalone:!0,features:[J],decls:3,vars:1,consts:[["mat-fab","","color","primary","aria-label","icon button with a delete icon",3,"disabled","click"]],template:function(h,d){h&1&&(D(0,"button",0),ft("click",function(){return d.addThought()}),D(1,"mat-icon"),gt(2,"add"),N()()),h&2&&mt("disabled",!d.condition())},dependencies:[pt,re,qc,ne,xr],styles:["[_nghost-%COMP%]{display:block}",".spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-toolbar[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-fab[_ngcontent-%COMP%]{background:linear-gradient(to right bottom,#eb054e,#db0a84,#a212d5)}.mat-mdc-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-unelevated-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-card-content[_ngcontent-%COMP%]{padding-bottom:16px}.mat-mdc-radio-button.mat-primary[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color: #fff;--mdc-radio-disabled-unselected-icon-color: #fff;--mdc-radio-unselected-hover-icon-color: #fff;--mdc-radio-unselected-icon-color: #fff;--mdc-radio-unselected-pressed-icon-color: #fff;--mdc-radio-selected-hover-icon-color: #fff;--mdc-radio-selected-focus-icon-color: #fff;--mdc-radio-selected-icon-color: #fff;--mdc-radio-selected-pressed-icon-color: #fff;--mat-radio-ripple-color: #fff;--mat-radio-checked-ripple-color: #fff;--mat-radio-disabled-label-color: #fff}"],changeDetection:0});let e=c;return e})();var I0=(()=>{let t=class t{constructor(){this.title="social-thoughts",this.seletor=W(Nr).seletor}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=X({type:t,selectors:[["app-application-wrapper"]],standalone:!0,features:[J],decls:4,vars:0,template:function(i,s){i&1&&yt(0,"app-toolbar")(1,"app-search-bar")(2,"app-thoughts-list")(3,"app-create-thought")},dependencies:[pt,mu,vu,jd,Kd],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;background-color:#fafafa;overflow:auto;position:relative;top:0}[_nghost-%COMP%]   app-create-thought[_ngcontent-%COMP%]{position:fixed;bottom:5vmin;right:5vmin}",".spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-toolbar[_ngcontent-%COMP%]{background-color:#fff}.mat-mdc-fab[_ngcontent-%COMP%]{background:linear-gradient(to right bottom,#eb054e,#db0a84,#a212d5)}.mat-mdc-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-unelevated-button[_ngcontent-%COMP%] > .mat-icon[_ngcontent-%COMP%]{margin-right:0}.mat-mdc-card-content[_ngcontent-%COMP%]{padding-bottom:16px}.mat-mdc-radio-button.mat-primary[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color: #fff;--mdc-radio-disabled-unselected-icon-color: #fff;--mdc-radio-unselected-hover-icon-color: #fff;--mdc-radio-unselected-icon-color: #fff;--mdc-radio-unselected-pressed-icon-color: #fff;--mdc-radio-selected-hover-icon-color: #fff;--mdc-radio-selected-focus-icon-color: #fff;--mdc-radio-selected-icon-color: #fff;--mdc-radio-selected-pressed-icon-color: #fff;--mat-radio-ripple-color: #fff;--mat-radio-checked-ripple-color: #fff;--mat-radio-disabled-label-color: #fff}"],changeDetection:0});let e=t;return e})();export{uv as a,lv as b,I0 as c};
